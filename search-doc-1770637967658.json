{"searchDocs":[{"title":"Configuration","type":0,"sectionRef":"#","url":"/databasement/self-hosting/configuration/","content":"","keywords":"","version":"Next"},{"title":"Sections​","type":1,"pageTitle":"Configuration","url":"/databasement/self-hosting/configuration/#sections","content":" Application - Core application settings including database, timezone, proxy configuration, and loggingBackup - Backup behavior, compression options, encryption, and S3 storage configurationNotification - Failure notifications via email, Slack, and DiscordSSO - OAuth and Single Sign-On authentication with Google, GitHub, GitLab, and OIDC providers ","version":"Next","tagName":"h2"},{"title":"Backup","type":0,"sectionRef":"#","url":"/databasement/self-hosting/configuration/backup","content":"","keywords":"","version":"Next"},{"title":"Encrypted Backups​","type":1,"pageTitle":"Backup","url":"/databasement/self-hosting/configuration/backup#encrypted-backups","content":" When using encrypted compression, backups are encrypted with AES-256 using 7-Zip. The encryption key defaults to APP_KEY, but you can set a dedicated key:  BACKUP_ENCRYPTION_KEY=base64:your-32-byte-key-here   You can generate a key with:  echo &quot;base64:$(openssl rand -base64 32)&quot;   warning If you change the encryption key, you will not be able to restore backups that were encrypted with the previous key. Keep your encryption key safe and backed up separately.  ","version":"Next","tagName":"h2"},{"title":"S3 Storage​","type":1,"pageTitle":"Backup","url":"/databasement/self-hosting/configuration/backup#s3-storage","content":" Databasement supports AWS S3 and S3-compatible storage (MinIO, DigitalOcean Spaces, etc.) for backup volumes.  We use environment variables to configure the S3 client.  ","version":"Next","tagName":"h2"},{"title":"S3 IAM Permissions​","type":1,"pageTitle":"Backup","url":"/databasement/self-hosting/configuration/backup#s3-iam-permissions","content":" The AWS credentials need these permissions:  { &quot;Version&quot;: &quot;2012-10-17&quot;, &quot;Statement&quot;: [ { &quot;Effect&quot;: &quot;Allow&quot;, &quot;Action&quot;: [ &quot;s3:PutObject&quot;, &quot;s3:GetObject&quot;, &quot;s3:DeleteObject&quot;, &quot;s3:ListBucket&quot; ], &quot;Resource&quot;: [ &quot;arn:aws:s3:::your-bucket-name&quot;, &quot;arn:aws:s3:::your-bucket-name/*&quot; ] } ] }   ","version":"Next","tagName":"h3"},{"title":"Access keys (Optional)​","type":1,"pageTitle":"Backup","url":"/databasement/self-hosting/configuration/backup#access-keys-optional","content":" This is not recommended but for standard AWS access using access keys:  AWS_ACCESS_KEY_ID=your-access-key AWS_SECRET_ACCESS_KEY=your-secret-key AWS_REGION=us-east-1   ","version":"Next","tagName":"h3"},{"title":"S3-Compatible Storage (MinIO, etc.)​","type":1,"pageTitle":"Backup","url":"/databasement/self-hosting/configuration/backup#s3-compatible-storage-minio-etc","content":" For S3-compatible storage providers, configure a custom endpoint:  AWS_ENDPOINT_URL_S3=https://minio.yourdomain.com AWS_USE_PATH_STYLE_ENDPOINT=true # AWS_PUBLIC_ENDPOINT_URL_S3=https://minio.yourdomain.com   tip If your internal endpoint differs from the public URL (e.g., http://minio:9000 vs http://localhost:9000), set AWS_PUBLIC_ENDPOINT_URL_S3 for presigned download URLs to work correctly in your browser.  ","version":"Next","tagName":"h3"},{"title":"IAM Role Assumption (Restricted Environments)​","type":1,"pageTitle":"Backup","url":"/databasement/self-hosting/configuration/backup#iam-role-assumption-restricted-environments","content":" To force Databasement to assume an IAM role, set the AWS_CUSTOM_ROLE_ARN environment variable:  AWS_CUSTOM_ROLE_ARN=arn:aws:iam::123456789:role/your-role-name   ","version":"Next","tagName":"h3"},{"title":"AWS Profile Support​","type":1,"pageTitle":"Backup","url":"/databasement/self-hosting/configuration/backup#aws-profile-support","content":" If using AWS credential profiles (from ~/.aws/credentials):  AWS_S3_PROFILE=my-s3-profile   ","version":"Next","tagName":"h3"},{"title":"All S3 Environment Variables​","type":1,"pageTitle":"Backup","url":"/databasement/self-hosting/configuration/backup#all-s3-environment-variables","content":" Variable\tDescription\tDefaultAWS_ACCESS_KEY_ID\tAWS access key (picked up automatically by SDK)\t- AWS_SECRET_ACCESS_KEY\tAWS secret key (picked up automatically by SDK)\t- AWS_REGION\tAWS region\tus-east-1 AWS_ENDPOINT_URL_S3\tCustom S3 endpoint URL (internal)\t- AWS_PUBLIC_ENDPOINT_URL_S3\tPublic S3 endpoint for presigned URLs\t- AWS_USE_PATH_STYLE_ENDPOINT\tUse path-style URLs (required for MinIO)\tfalse AWS_S3_PROFILE\tAWS credential profile for S3\t- AWS_CUSTOM_ROLE_ARN\tIAM custom role ARN to assume\t- AWS_ROLE_SESSION_NAME\tSession name for role assumption\tdatabasement AWS_ENDPOINT_URL_STS\tCustom STS endpoint URL\t- AWS_STS_PROFILE\tAWS credential profile for STS\t-  ","version":"Next","tagName":"h3"},{"title":"Show AWS Configuration​","type":1,"pageTitle":"Backup","url":"/databasement/self-hosting/configuration/backup#show-aws-configuration","content":" Debug the aws configuration by running:  php artisan config:show aws   This is where we create the S3 client: app/Services/Backup/Filesystems/Awss3Filesystem.php ","version":"Next","tagName":"h3"},{"title":"Development Guide","type":0,"sectionRef":"#","url":"/databasement/contributing/development","content":"","keywords":"","version":"Next"},{"title":"Requirements​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#requirements","content":" PHP 8.4+ComposerNode.js 20+ &amp; npmDocker &amp; Docker Compose  ","version":"Next","tagName":"h2"},{"title":"Quick Start​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#quick-start","content":" ","version":"Next","tagName":"h2"},{"title":"1. Clone and Setup​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#1-clone-and-setup","content":" git clone https://github.com/David-Crty/databasement.git cd databasement make setup   This will:  Install Composer dependenciesRun database migrationsInstall npm dependenciesBuild frontend assets  You should be ready to go!  Open http://localhost:2226 in your browser to view the app.  ","version":"Next","tagName":"h3"},{"title":"2. Start Development Environment​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#2-start-development-environment","content":" make start   This starts all Docker services:  php — FrankenPHP server on http://localhost:2226queue — Queue worker for async backup/restore jobsmysql — MySQL 8.0 on port 3306postgres — PostgreSQL 16 on port 5432  Test database credentials: admin / admin / testdb  ","version":"Next","tagName":"h3"},{"title":"Available Commands​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#available-commands","content":" All PHP commands run through Docker. Use the Makefile targets or docker compose exec app &lt;command&gt;.  ","version":"Next","tagName":"h2"},{"title":"Testing​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#testing","content":" make test # Run all tests make test-filter FILTER=ServerTest # Run specific tests make test-coverage # Run with coverage report   ","version":"Next","tagName":"h3"},{"title":"Code Quality​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#code-quality","content":" make lint-fix # Auto-fix code style with Laravel Pint make lint-check # Check code style without fixing make phpstan # Run PHPStan static analysis   ","version":"Next","tagName":"h3"},{"title":"Database​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#database","content":" make migrate # Run pending migrations make migrate-fresh # Drop all tables and re-migrate make migrate-fresh-seed # Fresh migration with seeders make db-seed # Run database seeders   ","version":"Next","tagName":"h3"},{"title":"Assets​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#assets","content":" npm run build # Build production assets npm run dev # Start Vite dev server (HMR) make build # Alternative: build via Makefile   ","version":"Next","tagName":"h3"},{"title":"Docker Services​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#docker-services","content":" make start # Start all services docker compose logs -f # View logs from all services docker compose logs -f queue # View queue worker logs docker compose restart queue # Restart queue worker docker compose down # Stop all services   ","version":"Next","tagName":"h3"},{"title":"OAuth / SSO Testing​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#oauth--sso-testing","content":" Databasement includes a Dex OIDC server for local OAuth testing. The Dex service is commented out by default in docker-compose.yml.  ","version":"Next","tagName":"h2"},{"title":"1. Add Hosts Entry​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#1-add-hosts-entry","content":" The Dex server uses a custom hostname that must resolve both from your browser and from within Docker containers:  echo &quot;127.0.0.1 dex-local&quot; | sudo tee -a /etc/hosts   ","version":"Next","tagName":"h3"},{"title":"2. Enable Dex Service​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#2-enable-dex-service","content":" Uncomment the dex service in docker-compose.yml:  ","version":"Next","tagName":"h3"},{"title":"3. Start Dex​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#3-start-dex","content":" docker compose up dex -d   ","version":"Next","tagName":"h3"},{"title":"4. Configure Environment​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#4-configure-environment","content":" Add to your .env.local:  OAUTH_OIDC_ENABLED=true OAUTH_OIDC_CLIENT_ID=databasement OAUTH_OIDC_CLIENT_SECRET=databasement-secret OAUTH_OIDC_BASE_URL=http://dex-local:5556/dex OAUTH_OIDC_LABEL=SSO   ","version":"Next","tagName":"h3"},{"title":"Test User​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#test-user","content":" Email\tPassworduser@databasement.com\tdatabasement  ","version":"Next","tagName":"h3"},{"title":"Testing Flow​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#testing-flow","content":" Ensure hosts entry is added (step 1)Start Dex: docker compose up dex -dVisit the login page at http://localhost:2226/loginClick &quot;Continue with SSO&quot;Enter test credentials: user@databasement.com / databasementYou'll be redirected back and logged in  ","version":"Next","tagName":"h3"},{"title":"OAuth Behavior Notes​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#oauth-behavior-notes","content":" New users: Created automatically with the role defined by OAUTH_DEFAULT_ROLEExisting users: When an existing user logs in via OAuth (matching email), their account is linked and their password is clearedOAuth-only users: Cannot use password login — they must use the OAuth buttonSettings access: OAuth-only users don't see Password or Two-Factor settings (managed by the OAuth provider)  ","version":"Next","tagName":"h3"},{"title":"Git Hooks​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#git-hooks","content":" Pre-commit hooks (via Husky) automatically run:  make lint-fix — Auto-format code with Laravel Pintmake test — Run all Pest tests  Ensure tests pass before committing.  ","version":"Next","tagName":"h2"},{"title":"Architecture Overview​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#architecture-overview","content":" ","version":"Next","tagName":"h2"},{"title":"Tech Stack​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#tech-stack","content":" Layer\tTechnologyBackend\tLaravel 12, PHP 8.4+ Frontend\tLivewire, Mary UI, daisyUI, Tailwind CSS 4 Testing\tPest PHP Database\tSQLite (dev), supports MySQL/PostgreSQL/MariaDB Auth\tLaravel Fortify with 2FA support  ","version":"Next","tagName":"h3"},{"title":"Key Models​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#key-models","content":" DatabaseServer — Database connection configurationsVolume — Storage destinations (local, S3)Backup — Backup configurations (schedule, retention, volume)Snapshot — Individual backup snapshots with metadataBackupJob — Tracks backup/restore job execution and logs  ","version":"Next","tagName":"h3"},{"title":"Key Services​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#key-services","content":" BackupTask — Executes database dumps, compression, and storageRestoreTask — Downloads, decompresses, and restores snapshotsDatabaseListService — Lists databases for autocompleteDatabaseConnectionTester — Validates database connectivityShellProcessor — Executes shell commands with logging  ","version":"Next","tagName":"h3"},{"title":"Livewire Components​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#livewire-components","content":" DatabaseServer/* — CRUD operations for database serversVolume/* — CRUD operations for storage volumesBackupJob/Index — Job listing with logs modalSnapshot/Index — Snapshot listing and managementSettings/* — User settings (Profile, Password, TwoFactor)RestoreModal — 3-step wizard for snapshot restoration  ","version":"Next","tagName":"h3"},{"title":"Backup & Restore Workflow​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#backup--restore-workflow","content":" Backup Process:  Connect to database serverExecute database-specific dump (mysqldump/pg_dump)Compress with gzipUpload to configured volume (local/S3)Record snapshot metadata  Restore Process:  Select source snapshotDownload and decompressValidate compatibility (database types must match)Drop and recreate target databaseRestore SQL dump  Cross-Server Restore: Restore production snapshots to staging/preprod as long as database types match.  ","version":"Next","tagName":"h3"},{"title":"Configuration​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#configuration","content":" ","version":"Next","tagName":"h2"},{"title":"Environment Variables​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#environment-variables","content":" The .env file is committed to the repository and contains default development configuration. To override these values, create a .env.local file (which is gitignored).  Key development configuration:  # Application APP_URL=http://localhost:2226 # Database (for application data) DB_CONNECTION=sqlite # Queue QUEUE_CONNECTION=database # AWS S3 (optional, for S3 volume testing) AWS_ACCESS_KEY_ID= AWS_SECRET_ACCESS_KEY= AWS_DEFAULT_REGION=us-east-1   ","version":"Next","tagName":"h3"},{"title":"Testing Strategy​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#testing-strategy","content":" We use Pest PHP for testing. Key principles:  Test business logic and behaviors — Not framework internalsMock external services — AWS SDK, S3 client, etc.Don't mock models — Use real database interactions  ","version":"Next","tagName":"h2"},{"title":"What to Test​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#what-to-test","content":" Authorization (who can access what)Business logic (backup works, restore works, cleanup deletes correct snapshots)Integration points (external services, commands)  ","version":"Next","tagName":"h3"},{"title":"What NOT to Test​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#what-not-to-test","content":" Form validation rules (Laravel handles this)Eloquent relationships and cascadesSession flash messagesFramework behavior  ","version":"Next","tagName":"h3"},{"title":"Submitting Changes​","type":1,"pageTitle":"Development Guide","url":"/databasement/contributing/development#submitting-changes","content":" Create a feature branch from mainWrite tests for new functionalityEnsure all tests pass: make testRun code quality checks: make lint-fix &amp;&amp; make phpstanSubmit a pull request with a clear description  For significant changes, open an issue first to discuss the approach. ","version":"Next","tagName":"h2"},{"title":"Notification","type":0,"sectionRef":"#","url":"/databasement/self-hosting/configuration/notification","content":"","keywords":"","version":"Next"},{"title":"Email​","type":1,"pageTitle":"Notification","url":"/databasement/self-hosting/configuration/notification#email","content":" Databasement uses Laravel's mail system. Configure your mail driver with these environment variables:  MAIL_MAILER=smtp MAIL_HOST=smtp.example.com MAIL_PORT=587 MAIL_USERNAME=your-username MAIL_PASSWORD=your-password MAIL_ENCRYPTION=tls MAIL_FROM_ADDRESS=databasement@example.com MAIL_FROM_NAME=&quot;Databasement&quot;   ","version":"Next","tagName":"h2"},{"title":"Slack​","type":1,"pageTitle":"Notification","url":"/databasement/self-hosting/configuration/notification#slack","content":" To receive failure notifications in Slack, you need to create an Incoming Webhook:  Go to Slack API AppsClick Create New App &gt; From scratchName your app (e.g., &quot;Databasement&quot;) and select your workspaceGo to Incoming Webhooks and toggle it onClick Add New Webhook to WorkspaceSelect the channel where you want notificationsCopy the webhook URL and paste it in the Configuration page  ","version":"Next","tagName":"h2"},{"title":"Discord​","type":1,"pageTitle":"Notification","url":"/databasement/self-hosting/configuration/notification#discord","content":" To receive failure notifications in Discord, you need a bot token and a channel ID.  ","version":"Next","tagName":"h2"},{"title":"Creating a Discord Bot​","type":1,"pageTitle":"Notification","url":"/databasement/self-hosting/configuration/notification#creating-a-discord-bot","content":" Go to Discord Developer PortalClick New Application and give it a name (e.g., &quot;Databasement&quot;)Go to Bot in the sidebar and click Add BotUnder Token, click Copy to get your bot tokenGo to OAuth2 &gt; URL GeneratorSelect scopes: botSelect bot permissions: Send Messages, Embed LinksCopy the generated URL and open it to invite the bot to your server  ","version":"Next","tagName":"h3"},{"title":"Getting a Channel ID​","type":1,"pageTitle":"Notification","url":"/databasement/self-hosting/configuration/notification#getting-a-channel-id","content":" Open Discord and go to User Settings &gt; AdvancedEnable Developer ModeRight-click the channel where you want notificationsClick Copy Channel ID  Enter both the Bot Token and Channel ID on the Configuration page.  ","version":"Next","tagName":"h3"},{"title":"What Gets Notified​","type":1,"pageTitle":"Notification","url":"/databasement/self-hosting/configuration/notification#what-gets-notified","content":" Notifications are sent only for failures:  Backup failures: When a scheduled or manual backup failsRestore failures: When a restore operation fails  Successful operations do not trigger notifications.  ","version":"Next","tagName":"h2"},{"title":"Notification Content​","type":1,"pageTitle":"Notification","url":"/databasement/self-hosting/configuration/notification#notification-content","content":" Each notification includes:  Server nameDatabase nameError messageTimestampDirect link to the failed job details ","version":"Next","tagName":"h2"},{"title":"Application","type":0,"sectionRef":"#","url":"/databasement/self-hosting/configuration/application","content":"","keywords":"","version":"Next"},{"title":"Application Settings​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#application-settings","content":" Variable\tDescription\tDefaultAPP_DEBUG\tEnable debug mode (set to false in production)\tfalse APP_URL\tFull URL where the app is accessible\thttp://localhost:2226 APP_KEY\tApplication encryption key (required)\t- TZ\tApplication timezone\tUTC  ","version":"Next","tagName":"h2"},{"title":"Timezone Configuration​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#timezone-configuration","content":" Set the TZ environment variable to configure the application timezone.  TZ=America/New_York TZ=Europe/London TZ=Asia/Tokyo   See the list of supported timezones.  ","version":"Next","tagName":"h3"},{"title":"Generating the Application Key​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#generating-the-application-key","content":" The APP_KEY is required for encryption. Generate one with:  docker run --rm davidcrty/databasement:latest php artisan key:generate --show   Copy the output (e.g., base64:xxxx...) and set it as APP_KEY.  ","version":"Next","tagName":"h3"},{"title":"Database Configuration​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#database-configuration","content":" Databasement needs a database to store its own data (users, servers, backup configurations).  ","version":"Next","tagName":"h2"},{"title":"SQLite (Simplest)​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#sqlite-simplest","content":" DB_CONNECTION=sqlite DB_DATABASE=/data/database.sqlite   note When using SQLite, make sure to mount a volume for /data to persist data.  ","version":"Next","tagName":"h3"},{"title":"MySQL / MariaDB​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#mysql--mariadb","content":" Create a database and user for Databasement on your MySQL server:  MySQL:  CREATE DATABASE databasement CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; CREATE USER 'databasement'@'%' IDENTIFIED BY 'your-secure-password'; GRANT ALL PRIVILEGES ON databasement.* TO 'databasement'@'%'; FLUSH PRIVILEGES;   DB_CONNECTION=mysql DB_HOST=your-mysql-host DB_PORT=3306 DB_DATABASE=databasement DB_USERNAME=databasement DB_PASSWORD=your-secure-password   ","version":"Next","tagName":"h3"},{"title":"PostgreSQL​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#postgresql","content":" Create a database and user for Databasement on your PostgreSQL server:  PostgreSQL:  CREATE DATABASE databasement; CREATE USER databasement WITH ENCRYPTED PASSWORD 'your-secure-password'; GRANT ALL PRIVILEGES ON DATABASE databasement TO databasement;   DB_CONNECTION=pgsql DB_HOST=your-postgres-host DB_PORT=5432 DB_DATABASE=databasement DB_USERNAME=databasement DB_PASSWORD=your-secure-password   ","version":"Next","tagName":"h3"},{"title":"Reverse Proxy / Trusted Proxies​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#reverse-proxy--trusted-proxies","content":" When running behind a reverse proxy (nginx, Traefik, Kubernetes Ingress), configure trusted proxies so Laravel can correctly determine the client IP and protocol. See the Troubleshooting section if you have issues with proxy configuration.  Variable\tDescription\tDefaultTRUSTED_PROXIES\tIP addresses or CIDR ranges of trusted proxies\t127.0.0.0/8,10.0.0.0/8,100.64.0.0/10,169.254.0.0/16,172.16.0.0/12,192.168.0.0/16  Alternative values:  * - Trust all proxies (simplest option for containerized environments)Comma-separated IPs/CIDRs: 10.0.0.1,192.168.1.0/24 - Trust specific proxies onlyEmpty - Trust no proxies  info Checks the Troubleshooting section for help with proxy configuration.  ","version":"Next","tagName":"h2"},{"title":"Logging​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#logging","content":" Variable\tDescription\tDefaultLOG_CHANNEL\tLogging channel\tstderr LOG_LEVEL\tMinimum log level\tdebug  For production, stderr is recommended as logs will be captured by Docker.  ","version":"Next","tagName":"h2"},{"title":"Complete Example​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#complete-example","content":" Here's a complete .env file for a production deployment with MySQL:  # Application APP_DEBUG=false APP_URL=https://backup.yourdomain.com APP_KEY=base64:your-generated-key-here # Database (for Databasement itself) DB_CONNECTION=mysql DB_HOST=mysql.yourdomain.com DB_PORT=3306 DB_DATABASE=databasement DB_USERNAME=databasement DB_PASSWORD=secure-password-here # Logging LOG_CHANNEL=stderr LOG_LEVEL=warning   ","version":"Next","tagName":"h2"},{"title":"Troubleshooting​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#troubleshooting","content":" ","version":"Next","tagName":"h2"},{"title":"Enable Debug Mode​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#enable-debug-mode","content":" Enable debug mode to access detailed diagnostics:  APP_DEBUG=true   Then visit https://your-domain.com/health/debug to view:  Current IP address and whether it's from a trusted proxyRequest headers (including X-Forwarded-For, X-Forwarded-Proto)Application configuration  ","version":"Next","tagName":"h3"},{"title":"Debugging Trusted Proxies​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#debugging-trusted-proxies","content":" If your application shows HTTP instead of HTTPS, or shows the wrong client IP:  Enable debug mode (see above) Visit /health/debug and check: is_trusted_proxy: Should be truesecure: Should be true for HTTPSheaders: Check x-forwarded-for and x-forwarded-proto Common issues: is_trusted_proxy: false → The proxy IP is not in your TRUSTED_PROXIES listsecure: false with HTTPS → Trusted proxy not configured, so x-forwarded-proto header is ignored Quick fix: Set TRUSTED_PROXIES=* to trust all proxies  ","version":"Next","tagName":"h3"},{"title":"More troubleshooting​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#more-troubleshooting","content":" If you encounter issues, see the Docker Compose Troubleshooting section for common problems and solutions.  See also Docker Networking if you're having issues connecting to your database server.  ","version":"Next","tagName":"h3"},{"title":"Run Artisan Commands​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#run-artisan-commands","content":" php artisan migrate:status # Check database migrations php artisan config:show database # View database configuration   ","version":"Next","tagName":"h3"},{"title":"Get Help​","type":1,"pageTitle":"Application","url":"/databasement/self-hosting/configuration/application#get-help","content":" Check the logs: docker compose logs appReport issues on GitHub ","version":"Next","tagName":"h3"},{"title":"SSO","type":0,"sectionRef":"#","url":"/databasement/self-hosting/configuration/sso","content":"","keywords":"","version":"Next"},{"title":"Supported Providers​","type":1,"pageTitle":"SSO","url":"/databasement/self-hosting/configuration/sso#supported-providers","content":" Google - Google Workspace and personal accountsGitHub - GitHub accountsGitLab - GitLab.com or self-hosted GitLabGeneric OIDC - Any OpenID Connect provider (Keycloak, Authentik, Dex, Okta, etc.)  Need another provider? Laravel Socialite supports many more providers including Facebook, Microsoft, Apple, Slack, and 100+ others. Feel free to submit a PR to add support for additional providers.  ","version":"Next","tagName":"h2"},{"title":"Configuration​","type":1,"pageTitle":"SSO","url":"/databasement/self-hosting/configuration/sso#configuration","content":" OAuth is configured via environment variables. Each provider can be enabled independently.  ","version":"Next","tagName":"h2"},{"title":"Google​","type":1,"pageTitle":"SSO","url":"/databasement/self-hosting/configuration/sso#google","content":" Create OAuth credentials in Google Cloud ConsoleSet authorized redirect URI to: https://your-domain.com/oauth/google/callbackConfigure environment variables:  OAUTH_GOOGLE_ENABLED=true OAUTH_GOOGLE_CLIENT_ID=your-client-id OAUTH_GOOGLE_CLIENT_SECRET=your-client-secret   ","version":"Next","tagName":"h3"},{"title":"GitHub​","type":1,"pageTitle":"SSO","url":"/databasement/self-hosting/configuration/sso#github","content":" Create an OAuth App in GitHub Developer SettingsSet authorization callback URL to: https://your-domain.com/oauth/github/callbackConfigure environment variables:  OAUTH_GITHUB_ENABLED=true OAUTH_GITHUB_CLIENT_ID=your-client-id OAUTH_GITHUB_CLIENT_SECRET=your-client-secret   ","version":"Next","tagName":"h3"},{"title":"GitLab​","type":1,"pageTitle":"SSO","url":"/databasement/self-hosting/configuration/sso#gitlab","content":" Create an OAuth application in GitLab (Admin Area &gt; Applications or User Settings &gt; Applications)Set redirect URI to: https://your-domain.com/oauth/gitlab/callbackConfigure environment variables:  OAUTH_GITLAB_ENABLED=true OAUTH_GITLAB_CLIENT_ID=your-application-id OAUTH_GITLAB_CLIENT_SECRET=your-secret OAUTH_GITLAB_HOST=https://gitlab.com # Or your self-hosted GitLab URL   ","version":"Next","tagName":"h3"},{"title":"Generic OIDC (Keycloak, Authentik, etc.)​","type":1,"pageTitle":"SSO","url":"/databasement/self-hosting/configuration/sso#generic-oidc-keycloak-authentik-etc","content":" For any OpenID Connect compatible provider:  Create a client/application in your identity providerSet redirect URI to: https://your-domain.com/oauth/oidc/callbackConfigure environment variables:  OAUTH_OIDC_ENABLED=true OAUTH_OIDC_CLIENT_ID=your-client-id OAUTH_OIDC_CLIENT_SECRET=your-client-secret OAUTH_OIDC_BASE_URL=https://your-idp.com/realms/your-realm # The OIDC base URL OAUTH_OIDC_LABEL=SSO # Button label on login page   Keycloak Setup​  In Keycloak Admin Console, go to Clients and click Create client Configure the client: Client ID: databasement (or your preferred name)Client authentication: On (required for confidential clients)Authentication flow: Check Standard flow (Authorization Code Flow) In the Settings tab, configure the URLs (replace databasement.example.com with your domain): Field\tValueRoot URL\thttps://databasement.example.com Home URL\thttps://databasement.example.com Valid redirect URIs\thttps://databasement.example.com/oauth/oidc/callback Valid post logout redirect URIs\thttps://databasement.example.com Web origins\thttps://databasement.example.com Go to the Credentials tab and copy the Client secret Configure environment variables:  OAUTH_OIDC_ENABLED=true OAUTH_OIDC_CLIENT_ID=databasement OAUTH_OIDC_CLIENT_SECRET=your-client-secret OAUTH_OIDC_BASE_URL=https://keycloak.example.com/realms/your-realm OAUTH_OIDC_LABEL=Keycloak   Finding the Issuer URL The issuer URL follows the pattern https://your-keycloak-server/realms/your-realm-name. You can find it in Realm Settings &gt; General &gt; Endpoints &gt; OpenID Endpoint Configuration.  Authentik Example​  OAUTH_OIDC_ENABLED=true OAUTH_OIDC_CLIENT_ID=databasement OAUTH_OIDC_CLIENT_SECRET=your-secret OAUTH_OIDC_BASE_URL=https://authentik.example.com/application/o/databasement/ OAUTH_OIDC_LABEL=Authentik   ","version":"Next","tagName":"h3"},{"title":"User Creation Settings​","type":1,"pageTitle":"SSO","url":"/databasement/self-hosting/configuration/sso#user-creation-settings","content":" ","version":"Next","tagName":"h2"},{"title":"Auto-Create Users​","type":1,"pageTitle":"SSO","url":"/databasement/self-hosting/configuration/sso#auto-create-users","content":" When enabled (default), new users are automatically created when they log in via OAuth for the first time:  OAUTH_AUTO_CREATE_USERS=true # Default: true   Set to false to only allow existing users to log in via OAuth.  ","version":"Next","tagName":"h3"},{"title":"Default Role​","type":1,"pageTitle":"SSO","url":"/databasement/self-hosting/configuration/sso#default-role","content":" New users created via OAuth are assigned this role:  OAUTH_DEFAULT_ROLE=member # Options: viewer, member, admin   ","version":"Next","tagName":"h3"},{"title":"Auto-Link by Email​","type":1,"pageTitle":"SSO","url":"/databasement/self-hosting/configuration/sso#auto-link-by-email","content":" When enabled (default), OAuth logins are automatically linked to existing users with matching email addresses:  OAUTH_AUTO_LINK_BY_EMAIL=true # Default: true   For local development OAuth testing, see the Development Guide. ","version":"Next","tagName":"h3"},{"title":"Docker","type":0,"sectionRef":"#","url":"/databasement/self-hosting/docker","content":"","keywords":"","version":"Next"},{"title":"Prerequisites​","type":1,"pageTitle":"Docker","url":"/databasement/self-hosting/docker#prerequisites","content":" Docker installed on your system  ","version":"Next","tagName":"h2"},{"title":"Quick Start (SQLite)​","type":1,"pageTitle":"Docker","url":"/databasement/self-hosting/docker#quick-start-sqlite","content":" The simplest way to run Databasement with SQLite as the database:  # Generate an application key APP_KEY=$(docker run --rm davidcrty/databasement:latest php artisan key:generate --show) # Run the container docker run -d \\ --name databasement \\ -p 2226:2226 \\ -e APP_KEY=$APP_KEY \\ -e DB_CONNECTION=sqlite \\ -e DB_DATABASE=/data/database.sqlite \\ -e ENABLE_QUEUE_WORKER=true \\ -v ./databasement-data:/data \\ davidcrty/databasement:latest   note The ENABLE_QUEUE_WORKER=true environment variable enables the background queue worker inside the container. This is required for processing backup and restore jobs. When using Docker Compose, the worker runs as a separate service instead.  Access the application at http://localhost:2226  S3 Storage To store backups in AWS S3 or S3-compatible storage (MinIO, DigitalOcean Spaces, etc.), see the S3 Storage Configuration section.  ","version":"Next","tagName":"h2"},{"title":"Custom User ID (PUID/PGID)​","type":1,"pageTitle":"Docker","url":"/databasement/self-hosting/docker#custom-user-id-puidpgid","content":" By default, the application runs as PUID/PGID 1000. You can customize this using the PUID and PGID environment variables:  # Run with custom PUID/PGID docker run -d \\ ... -e PUID=1001 \\ -e PGID=1001 \\ ...   tip Find your user's PUID/PGID with id username. The container will automatically set the correct permissions on /data for the specified PUID/PGID.  ","version":"Next","tagName":"h2"},{"title":"Rootless Containers​","type":1,"pageTitle":"Docker","url":"/databasement/self-hosting/docker#rootless-containers","content":" For rootless Docker or Podman environments, use the --user flag. When using this method, the container runs entirely as the specified user and skips the automatic permission fix:  # Create the data directory and set permissions first mkdir /path/to/databasement/data sudo chown 499:499 /path/to/databasement/data docker run -d \\ ... --user 499:499 \\ ...   note When using --user, you must manually set /data directory volume permissions before starting the container since the automatic permission fix requires root: sudo chown 499:499 /path/to/databasement/data  ","version":"Next","tagName":"h3"},{"title":"Troubleshooting​","type":1,"pageTitle":"Docker","url":"/databasement/self-hosting/docker#troubleshooting","content":" If you encounter issues, see the Docker Compose Troubleshooting section for common problems and solutions.  For additional troubleshooting options including debug mode and configuration issues, see the Configuration Troubleshooting section.  See also Docker Networking if you're having issues connecting to your database server. ","version":"Next","tagName":"h2"},{"title":"Introduction","type":0,"sectionRef":"#","url":"/databasement/self-hosting/intro","content":"","keywords":"","version":"Next"},{"title":"Getting Started​","type":1,"pageTitle":"Introduction","url":"/databasement/self-hosting/intro#getting-started","content":" We provide guides to deploy Databasement using:  Docker - Single container deployment (recommended for most users)Docker Compose - Multi-container setup with external databaseKubernetes + Helm - For Kubernetes clustersNative Ubuntu - Traditional installation without Docker  ","version":"Next","tagName":"h2"},{"title":"Requirements​","type":1,"pageTitle":"Introduction","url":"/databasement/self-hosting/intro#requirements","content":" Databasement runs in a single container that includes:  FrankenPHP web serverQueue worker for async backup/restore jobsScheduler for automated backups  The only external requirement is a database for the application itself:  SQLite (simplest, built into the container)MySQL/MariaDB or PostgreSQL (recommended for production)  ","version":"Next","tagName":"h2"},{"title":"Quick Start​","type":1,"pageTitle":"Introduction","url":"/databasement/self-hosting/intro#quick-start","content":" The fastest way to try Databasement:  docker run -d \\ --name databasement \\ -p 2226:2226 \\ -v databasement-data:/app/storage \\ davidcrty/databasement:latest   Then open http://localhost:2226 in your browser.  note This quick start uses SQLite for the application database. For production deployments, see the Docker guide for recommended configurations.  ","version":"Next","tagName":"h2"},{"title":"Support​","type":1,"pageTitle":"Introduction","url":"/databasement/self-hosting/intro#support","content":" If you encounter issues with self-hosting, please open an issue on GitHub. ","version":"Next","tagName":"h2"},{"title":"Kubernetes + Helm","type":0,"sectionRef":"#","url":"/databasement/self-hosting/kubernetes-helm","content":"","keywords":"","version":"Next"},{"title":"Installation​","type":1,"pageTitle":"Kubernetes + Helm","url":"/databasement/self-hosting/kubernetes-helm#installation","content":" ","version":"Next","tagName":"h2"},{"title":"1. Add the Helm Repository​","type":1,"pageTitle":"Kubernetes + Helm","url":"/databasement/self-hosting/kubernetes-helm#1-add-the-helm-repository","content":" helm repo add databasement https://david-crty.github.io/databasement helm repo update   ","version":"Next","tagName":"h3"},{"title":"2. Generate an Application Key​","type":1,"pageTitle":"Kubernetes + Helm","url":"/databasement/self-hosting/kubernetes-helm#2-generate-an-application-key","content":" Before deploying, generate an application encryption key:  docker run --rm davidcrty/databasement:latest php artisan key:generate --show   Copy the output (e.g., base64:abc123...) for use in your values file.  ","version":"Next","tagName":"h3"},{"title":"3. Create a Values File​","type":1,"pageTitle":"Kubernetes + Helm","url":"/databasement/self-hosting/kubernetes-helm#3-create-a-values-file","content":" Minimal Configuration (SQLite)​  For simple deployments using SQLite:  values.yaml app: url: https://backup.yourdomain.com appKey: value: &quot;base64:your-generated-key-here&quot; ingress: enabled: true className: nginx host: backup.yourdomain.com # For HTTPS using cert-manager: # tlsSecretName: databasement-tls # annotations: # cert-manager.io/cluster-issuer: letsencrypt-prod   Production Configuration (External Database)​  For production, we recommend using MySQL or PostgreSQL instead of SQLite:  values.yaml # ... other app config database: connection: mysql # or pgsql host: your-mysql-host.example.com port: 3306 name: databasement username: databasement password: value: &quot;your-secure-password&quot; ingress: enabled: true className: nginx host: backup.yourdomain.com   Using Existing Secrets​  For sensitive values, you can reference existing Kubernetes secrets instead of storing them in your values file:  values.yaml app: appKey: fromSecret: secretName: &quot;my-app-secret&quot; secretKey: &quot;APP_KEY&quot; database: connection: mysql host: mysql.example.com name: databasement username: databasement password: fromSecret: secretName: &quot;my-db-secret&quot; secretKey: &quot;password&quot;   ","version":"Next","tagName":"h3"},{"title":"4. Install the Chart​","type":1,"pageTitle":"Kubernetes + Helm","url":"/databasement/self-hosting/kubernetes-helm#4-install-the-chart","content":" helm upgrade --install databasement databasement/databasement -f values.yaml   ","version":"Next","tagName":"h3"},{"title":"Configuration​","type":1,"pageTitle":"Kubernetes + Helm","url":"/databasement/self-hosting/kubernetes-helm#configuration","content":" For the full list of configurable parameters, see the values.yaml file.  For all available environment variables, see the Configuration page.  ","version":"Next","tagName":"h2"},{"title":"Custom Environment Variables​","type":1,"pageTitle":"Kubernetes + Helm","url":"/databasement/self-hosting/kubernetes-helm#custom-environment-variables","content":" Use extraEnv to pass additional environment variables:  extraEnv: AWS_ACCESS_KEY_ID: &quot;your-access-key&quot; AWS_SECRET_ACCESS_KEY: &quot;your-secret-key&quot; AWS_DEFAULT_REGION: &quot;us-east-1&quot;   S3 Storage To store backups in AWS S3 or S3-compatible storage (MinIO, DigitalOcean Spaces, etc.), see the S3 Storage Configuration section for all available options.  ","version":"Next","tagName":"h3"},{"title":"Environment Variables from Secrets/ConfigMaps​","type":1,"pageTitle":"Kubernetes + Helm","url":"/databasement/self-hosting/kubernetes-helm#environment-variables-from-secretsconfigmaps","content":" Use extraEnvFrom to load environment variables from existing secrets or configmaps:  extraEnvFrom: - secretRef: name: aws-credentials - configMapRef: name: app-config   This is useful for injecting credentials managed by external secret management tools (e.g., External Secrets Operator, Sealed Secrets).  ","version":"Next","tagName":"h3"},{"title":"Persistence​","type":1,"pageTitle":"Kubernetes + Helm","url":"/databasement/self-hosting/kubernetes-helm#persistence","content":" By default, persistence is enabled with a 10Gi volume:  persistence: enabled: true storageClass: &quot;&quot; # Uses default storage class size: 10Gi accessModes: - ReadWriteOnce   ","version":"Next","tagName":"h3"},{"title":"Worker Configuration​","type":1,"pageTitle":"Kubernetes + Helm","url":"/databasement/self-hosting/kubernetes-helm#worker-configuration","content":" The queue worker runs as a sidecar container by default. You can customize its behavior:  worker: enabled: true command: &quot;php artisan queue:work --queue=backups,default --tries=3 --timeout=3600&quot; resources: limits: cpu: 500m memory: 512Mi requests: cpu: 100m memory: 256Mi   For high-availability setups with an external database, you can run the worker as a separate deployment:  worker: separateDeployment: true replicaCount: 2   note Separate worker deployment requires either ReadWriteMany storage or AWS S3 storage + an external database (MySQL/PostgreSQL).  ","version":"Next","tagName":"h3"},{"title":"Troubleshooting​","type":1,"pageTitle":"Kubernetes + Helm","url":"/databasement/self-hosting/kubernetes-helm#troubleshooting","content":" For additional troubleshooting options including debug mode and configuration issues, see the Configuration Troubleshooting section. ","version":"Next","tagName":"h2"},{"title":"Backups","type":0,"sectionRef":"#","url":"/databasement/user-guide/backups","content":"","keywords":"","version":"Next"},{"title":"How Backups Work​","type":1,"pageTitle":"Backups","url":"/databasement/user-guide/backups#how-backups-work","content":" When you create a backup, Databasement:  Connects to the database serverRuns the appropriate dump command (mysqldump or pg_dump)Compresses the output with gzipTransfers the compressed file to the selected storage volumeCreates a snapshot record with metadata  ","version":"Next","tagName":"h2"},{"title":"Backup Commands​","type":1,"pageTitle":"Backups","url":"/databasement/user-guide/backups#backup-commands","content":" Databasement uses native database tools for reliable backups:  MySQL/MariaDB:  mariadb-dump --routines --add-drop-table --complete-insert --hex-blob --quote-names --skip_ssl \\ --host='...' --port='...' --user='...' --password='...' 'database_name' &gt; dump.sql   PostgreSQL:  PGPASSWORD='...' pg_dump --clean --if-exists --no-owner --no-privileges --quote-all-identifiers \\ --host='...' --port='...' --username='...' 'database_name' -f dump.sql   SQLite:  cp '/path/to/database.sqlite' dump.db   All dumps are then compressed with gzip before being transferred to the storage volume.  ","version":"Next","tagName":"h3"},{"title":"Failed Backups​","type":1,"pageTitle":"Backups","url":"/databasement/user-guide/backups#failed-backups","content":" If a backup fails, check:  Database connectivity: Can Databasement still connect to the server?Disk space: Is there enough space on the storage volume?Permissions: Does the database user have backup privileges?Timeout: Large databases may need more time  Failed backup reasons are logged and visible in the snapshot details.  ","version":"Next","tagName":"h2"},{"title":"Retention Policies​","type":1,"pageTitle":"Backups","url":"/databasement/user-guide/backups#retention-policies","content":" Retention policies control how long backups are kept before being automatically deleted. Databasement offers two retention strategies:  ","version":"Next","tagName":"h2"},{"title":"Simple (Days-Based)​","type":1,"pageTitle":"Backups","url":"/databasement/user-guide/backups#simple-days-based","content":" The simplest option: keep all backups for a specified number of days.  Example: With retention_days = 30, any backup older than 30 days is automatically deleted.  Day\tBackups Kept1-30\tAll backups 31+\tDeleted  Best for: Short-term backup needs, development environments, or when storage cost isn't a concern.  ","version":"Next","tagName":"h3"},{"title":"GFS (Grandfather-Father-Son)​","type":1,"pageTitle":"Backups","url":"/databasement/user-guide/backups#gfs-grandfather-father-son","content":" A tiered retention strategy that keeps recent backups for quick recovery while preserving older snapshots for long-term archival — without keeping every single backup.  How it works:  Tier\tWhat it keeps\tExampleDaily (Son)\tThe N most recent backups\tKeep last 7 backups Weekly (Father)\t1 backup per week for N weeks\tKeep 1/week for 4 weeks Monthly (Grandfather)\t1 backup per month for N months\tKeep 1/month for 12 months  Example with default values (7 daily, 4 weekly, 12 monthly):  After running daily backups for a year, you'll have approximately:  7 recent backups (last 7 days)4 weekly backups (one from each of the past 4 weeks)12 monthly backups (one from each of the past 12 months)  Total: ~23 backups instead of 365 — saving significant storage while maintaining recovery points across the entire year.  Timeline visualization: Today ◄─────────────────────────────────────────────── 1 year ago │ │ ├── Daily ──┤ (7 backups) │ │ │ │ ├── Weekly ─────────┤ (4 backups) │ │ │ │ └── Monthly ─────────────────────────────────────────────┘ (12 backups)   Best for: Production environments, compliance requirements, or when you need long-term recovery options without excessive storage costs.  Per-Database Retention Retention policies are applied per database, not per server. If you backup 3 databases with GFS (7 daily), each database keeps its own 7 most recent backups — totaling 21 backups across all databases.  ","version":"Next","tagName":"h3"},{"title":"Choosing a Retention Policy​","type":1,"pageTitle":"Backups","url":"/databasement/user-guide/backups#choosing-a-retention-policy","content":" Scenario\tRecommended PolicyDevelopment/testing\tSimple: 7-14 days Small production app\tSimple: 30 days Business-critical data\tGFS: 7d/4w/12m Compliance requirements\tGFS: 14d/8w/24m  tip You can disable any GFS tier by leaving it empty. For example, setting only &quot;Monthly: 12&quot; keeps just one backup per month for a year.  ","version":"Next","tagName":"h3"},{"title":"Best Practices​","type":1,"pageTitle":"Backups","url":"/databasement/user-guide/backups#best-practices","content":" ","version":"Next","tagName":"h2"},{"title":"Before Production Backups​","type":1,"pageTitle":"Backups","url":"/databasement/user-guide/backups#before-production-backups","content":" Test the connection before creating backupsVerify restore by testing a restore to a development serverMonitor disk space on your storage volumes  ","version":"Next","tagName":"h3"},{"title":"Backup Sizing​","type":1,"pageTitle":"Backups","url":"/databasement/user-guide/backups#backup-sizing","content":" Compressed backup sizes vary, but as a rough guide:  A 1GB database typically compresses to 100-300MBText-heavy data compresses better than binary data  ","version":"Next","tagName":"h3"},{"title":"Security Considerations​","type":1,"pageTitle":"Backups","url":"/databasement/user-guide/backups#security-considerations","content":" Use dedicated backup users with minimal required privilegesStore backups in secure, encrypted storage when possibleRegularly test your restore process ","version":"Next","tagName":"h3"},{"title":"Docker Compose","type":0,"sectionRef":"#","url":"/databasement/self-hosting/docker-compose","content":"","keywords":"","version":"Next"},{"title":"Prerequisites​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#prerequisites","content":" Docker and Docker Compose  ","version":"Next","tagName":"h2"},{"title":"Quick Start​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#quick-start","content":" ","version":"Next","tagName":"h2"},{"title":"1. Create Project Directory​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#1-create-project-directory","content":" mkdir databasement &amp;&amp; cd databasement   ","version":"Next","tagName":"h3"},{"title":"2. Generate Application Key​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#2-generate-application-key","content":" docker run --rm davidcrty/databasement:latest php artisan key:generate --show   Save this key for the next step.  ","version":"Next","tagName":"h3"},{"title":"3. Create Environment File​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#3-create-environment-file","content":" Create a .env file with your configuration. This file is shared between the app and worker services to ensure consistent settings.  SQLite​  .env APP_URL=http://localhost:2226 APP_KEY=base64:your-generated-key-here # Database (SQLite) DB_CONNECTION=sqlite DB_DATABASE=/data/database.sqlite   MySQL​  .env APP_URL=http://localhost:2226 APP_KEY=base64:your-generated-key-here # Database (MySQL) DB_CONNECTION=mysql DB_HOST=mysql DB_PORT=3306 DB_DATABASE=databasement DB_USERNAME=databasement DB_PASSWORD=your-secure-password   PostgreSQL​  .env APP_URL=http://localhost:2226 APP_KEY=base64:your-generated-key-here # Database (PostgreSQL) DB_CONNECTION=pgsql DB_HOST=postgres DB_PORT=5432 DB_DATABASE=databasement DB_USERNAME=databasement DB_PASSWORD=your-secure-password   S3 Storage To store backups in AWS S3 or S3-compatible storage (MinIO, DigitalOcean Spaces, etc.), see the S3 Storage Configuration section.  ","version":"Next","tagName":"h3"},{"title":"4. Create docker-compose.yml​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#4-create-docker-composeyml","content":" SQLite​  docker-compose.yml services: app: image: davidcrty/databasement:latest container_name: databasement restart: unless-stopped ports: - &quot;2226:2226&quot; env_file: .env volumes: - ./data:/data healthcheck: test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost:2226/health&quot;] interval: 10s timeout: 5s retries: 5 worker: image: davidcrty/databasement:latest container_name: databasement-worker restart: unless-stopped command: sh -c &quot;php artisan db:wait --check-migrations &amp;&amp; php artisan queue:work --queue=backups,default --tries=3 --timeout=3600 --sleep=3 --max-jobs=1000&quot; env_file: .env volumes: - ./data:/data depends_on: app: condition: service_healthy   MySQL​  docker-compose.yml services: app: image: davidcrty/databasement:latest container_name: databasement restart: unless-stopped ports: - &quot;2226:2226&quot; env_file: .env volumes: - ./data:/data depends_on: mysql: condition: service_healthy healthcheck: test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost:2226/health&quot;] interval: 10s timeout: 5s retries: 5 worker: image: davidcrty/databasement:latest container_name: databasement-worker restart: unless-stopped command: sh -c &quot;php artisan db:wait --check-migrations &amp;&amp; php artisan queue:work --queue=backups,default --tries=3 --timeout=3600 --sleep=3 --max-jobs=1000&quot; env_file: .env volumes: - ./data:/data depends_on: app: condition: service_healthy mysql: condition: service_healthy mysql: image: mysql:8.0 container_name: databasement-mysql restart: unless-stopped environment: MYSQL_ROOT_PASSWORD: your-root-password MYSQL_DATABASE: databasement MYSQL_USER: databasement MYSQL_PASSWORD: your-secure-password volumes: - ./mysql-data:/var/lib/mysql healthcheck: test: [&quot;CMD&quot;, &quot;mysqladmin&quot;, &quot;ping&quot;, &quot;-h&quot;, &quot;localhost&quot;] interval: 10s timeout: 5s retries: 5   PostgreSQL​  docker-compose.yml services: app: image: davidcrty/databasement:latest container_name: databasement restart: unless-stopped ports: - &quot;2226:2226&quot; env_file: .env volumes: - ./data:/data depends_on: postgres: condition: service_healthy healthcheck: test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost:2226/health&quot;] interval: 10s timeout: 5s retries: 5 worker: image: davidcrty/databasement:latest container_name: databasement-worker restart: unless-stopped command: sh -c &quot;php artisan db:wait --check-migrations &amp;&amp; php artisan queue:work --queue=backups,default --tries=3 --timeout=3600 --sleep=3 --max-jobs=1000&quot; env_file: .env volumes: - ./data:/data depends_on: app: condition: service_healthy postgres: condition: service_healthy postgres: image: postgres:16 container_name: databasement-postgres restart: unless-stopped environment: POSTGRES_DB: databasement POSTGRES_USER: databasement POSTGRES_PASSWORD: your-secure-password volumes: - ./postgres-data:/var/lib/postgresql/data healthcheck: test: [&quot;CMD-SHELL&quot;, &quot;pg_isready -U databasement -d databasement&quot;] interval: 10s timeout: 5s retries: 5   tip Remember to restart both the app and worker services whenever you change the .env file: docker compose restart app worker  tip The worker service runs the Laravel queue worker as a separate container. This provides better stability and allows independent restarts without affecting the web application. The worker processes backup and restore jobs from the queue.  ","version":"Next","tagName":"h3"},{"title":"5. Start the Services​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#5-start-the-services","content":" docker compose up -d   ","version":"Next","tagName":"h3"},{"title":"6. Verify the Setup​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#6-verify-the-setup","content":" Wait for all services to be healthy, then verify the application is running:  # Check service status docker compose ps # Verify health endpoint curl http://localhost:2226/health   ","version":"Next","tagName":"h3"},{"title":"7. Access the Application​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#7-access-the-application","content":" Open http://localhost:2226 in your browser.  note To expose your Databasement instance with HTTPS, you can use Traefik as a reverse proxy. For detailed instructions on how to configure Traefik with Docker, please refer to the official Traefik documentation.  ","version":"Next","tagName":"h3"},{"title":"Custom User ID (PUID/PGID)​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#custom-user-id-puidpgid","content":" By default, the application runs as PUID/PGID 1000. You can customize this using the PUID and PGID environment variables:  docker-compose.yml services: app: image: davidcrty/databasement:latest environment: PUID: 1001 PGID: 1001 # ... rest of config worker: image: davidcrty/databasement:latest environment: PUID: 1001 PGID: 1001 # ... rest of config   tip Find your user's PUID/PGID with id username. The container will automatically set the correct permissions on /data for the specified PUID/PGID.  ","version":"Next","tagName":"h2"},{"title":"Rootless Containers​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#rootless-containers","content":" For rootless Docker or Podman environments, use the user directive. When using this method, the container runs entirely as the specified user and skips the automatic permission fix:  services: app: image: davidcrty/databasement:latest user: &quot;1010:1010&quot; # ... rest of config worker: image: davidcrty/databasement:latest user: &quot;1010:1010&quot; # ... rest of config   note When using user, you must manually set /data directory volume permissions before starting the container since the automatic permission fix requires root: sudo chown 1010:1010 /path/to/databasement/data  ","version":"Next","tagName":"h3"},{"title":"Troubleshooting​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#troubleshooting","content":" ","version":"Next","tagName":"h2"},{"title":"Database connection errors​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#database-connection-errors","content":" SQLSTATE[HY000] [2002] No such file or directory # or SQLSTATE[HY000] [2002] Connection refused   Cause: The database container isn't ready yet, or the port/host configuration is incorrect.  Solution:  Check if the database container is healthy: docker compose psVerify DB_PORT matches your database (MySQL: 3306, PostgreSQL: 5432)Ensure DB_HOST matches your Docker Compose service name exactly (e.g. mysql or postgres)  ","version":"Next","tagName":"h3"},{"title":"Container keeps restarting​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#container-keeps-restarting","content":" Cause: Application error during startup.  Solution: Check the logs to identify the issue:  docker compose logs -f app docker compose logs -f worker   ","version":"Next","tagName":"h3"},{"title":"Permission denied on /data​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#permission-denied-on-data","content":" Cause: The container user doesn't have write access to the mounted volume.  Solution: Either:  Set PUID/PGID to match your host user (see Custom User ID)Or fix permissions manually: sudo chown -R 1000:1000 ./data (replace 1000 with your PUID/PGID)  ","version":"Next","tagName":"h3"},{"title":"Database tables are empty after startup​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#database-tables-are-empty-after-startup","content":" Cause: This is expected on first run. Migrations run automatically when the app starts.  Solution: Check if migrations ran successfully:  docker compose logs app | grep -i migration   You should see: All migrations have been run!  ","version":"Next","tagName":"h3"},{"title":"More troubleshooting​","type":1,"pageTitle":"Docker Compose","url":"/databasement/self-hosting/docker-compose#more-troubleshooting","content":" For additional troubleshooting options including debug mode, trusted proxy configuration, and artisan commands, see the Configuration Troubleshooting section.  See also Docker Networking if you're having issues connecting to your database server. ","version":"Next","tagName":"h3"},{"title":"Introduction","type":0,"sectionRef":"#","url":"/databasement/user-guide/intro","content":"","keywords":"","version":"Next"},{"title":"Getting Started​","type":1,"pageTitle":"Introduction","url":"/databasement/user-guide/intro#getting-started","content":" After installing Databasement, access the web interface and create your first account.  ","version":"Next","tagName":"h2"},{"title":"1. Create Your Account​","type":1,"pageTitle":"Introduction","url":"/databasement/user-guide/intro#1-create-your-account","content":" When you first access Databasement, you'll be prompted to register. Create an account with:  Your nameEmail addressPassword  Two-factor authentication can be enabled later in your account settings for additional security.  ","version":"Next","tagName":"h3"},{"title":"2. Add a Database Server​","type":1,"pageTitle":"Introduction","url":"/databasement/user-guide/intro#2-add-a-database-server","content":" Navigate to Database Servers and click Add Server. You'll need:  Name: A friendly name for this server (e.g., &quot;Production MySQL&quot;)Type: MySQL, PostgreSQL, or MariaDBHost: The server hostname or IP addressPort: The database port (default: 3306 for MySQL, 5432 for PostgreSQL)Username: Database user with backup privilegesPassword: The database password  Click Test Connection to verify the connection before saving.  ","version":"Next","tagName":"h3"},{"title":"3. Create a Storage Volume​","type":1,"pageTitle":"Introduction","url":"/databasement/user-guide/intro#3-create-a-storage-volume","content":" Before creating backups, you need a storage volume. Navigate to Volumes and click Add Volume.  Databasement supports:  Local storage: Store backups on the server's filesystemS3-compatible storage: Amazon S3, MinIO, DigitalOcean Spaces, etc.  ","version":"Next","tagName":"h3"},{"title":"4. Create Your First Backup​","type":1,"pageTitle":"Introduction","url":"/databasement/user-guide/intro#4-create-your-first-backup","content":" Go to Database Servers, find your server, and click Backup. Select the database and storage volume, then start the backup.  Backups run asynchronously - you can navigate away and check progress later on the Snapshots page.  ","version":"Next","tagName":"h3"},{"title":"5. Restore a Snapshot​","type":1,"pageTitle":"Introduction","url":"/databasement/user-guide/intro#5-restore-a-snapshot","content":" To restore a backup, go to Snapshots, find the snapshot you want to restore, and click Restore. You can restore to:  The same server and database (rollback)A different database on the same serverA completely different server (cross-server restore)  ","version":"Next","tagName":"h3"},{"title":"Next Steps​","type":1,"pageTitle":"Introduction","url":"/databasement/user-guide/intro#next-steps","content":" Managing Database ServersConfiguring BackupsWorking with SnapshotsStorage VolumesPermissions ","version":"Next","tagName":"h2"},{"title":"Permissions","type":0,"sectionRef":"#","url":"/databasement/user-guide/permissions","content":"","keywords":"","version":"Next"},{"title":"User Roles​","type":1,"pageTitle":"Permissions","url":"/databasement/user-guide/permissions#user-roles","content":" Role\tDescriptionAdmin\tFull access to all features including user management Member\tCan manage database servers, volumes, and backups, but cannot manage users Viewer\tRead-only access to view resources and monitor backup status  ","version":"Next","tagName":"h2"},{"title":"Permissions by Resource​","type":1,"pageTitle":"Permissions","url":"/databasement/user-guide/permissions#permissions-by-resource","content":" ","version":"Next","tagName":"h2"},{"title":"Database Servers​","type":1,"pageTitle":"Permissions","url":"/databasement/user-guide/permissions#database-servers","content":" Action\tViewer\tMember\tAdminView list\t✅\t✅\t✅ Create\t❌\t✅\t✅ Edit\t❌\t✅\t✅ Delete\t❌\t✅\t✅ Run backup\t❌\t✅\t✅ Restore to server\t❌\t✅\t✅  ","version":"Next","tagName":"h3"},{"title":"Volumes​","type":1,"pageTitle":"Permissions","url":"/databasement/user-guide/permissions#volumes","content":" Action\tViewer\tMember\tAdminView list\t✅\t✅\t✅ Create\t❌\t✅\t✅ Edit\t❌\t✅\t✅ Delete\t❌\t✅\t✅  ","version":"Next","tagName":"h3"},{"title":"Snapshots​","type":1,"pageTitle":"Permissions","url":"/databasement/user-guide/permissions#snapshots","content":" Action\tViewer\tMember\tAdminView list\t✅\t✅\t✅ View details\t✅\t✅\t✅ Download\t❌\t✅\t✅ Delete\t❌\t✅\t✅  ","version":"Next","tagName":"h3"},{"title":"Users​","type":1,"pageTitle":"Permissions","url":"/databasement/user-guide/permissions#users","content":" Action\tViewer\tMember\tAdminView list\t✅\t✅\t✅ Invite new user\t❌\t❌\t✅ Edit user role\t❌\t❌\t✅ Delete user\t❌\t❌\t✅ Copy invitation link\t❌\t❌\t✅  ","version":"Next","tagName":"h3"},{"title":"Special Rules​","type":1,"pageTitle":"Permissions","url":"/databasement/user-guide/permissions#special-rules","content":" ","version":"Next","tagName":"h2"},{"title":"User Deletion Restrictions​","type":1,"pageTitle":"Permissions","url":"/databasement/user-guide/permissions#user-deletion-restrictions","content":" Even admins have some restrictions when deleting users:  Cannot delete yourself: An admin cannot delete their own accountCannot delete the last admin: The system must always have at least one admin user ","version":"Next","tagName":"h3"},{"title":"Native Ubuntu Installation","type":0,"sectionRef":"#","url":"/databasement/self-hosting/native-ubuntu","content":"","keywords":"","version":"Next"},{"title":"Prerequisites​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#prerequisites","content":" Ubuntu 22.04 LTS or 24.04 LTSRoot or sudo accessA web server (Nginx or Apache)  ","version":"Next","tagName":"h2"},{"title":"Install PHP 8.4​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#install-php-84","content":" # Add PHP repository sudo add-apt-repository ppa:ondrej/php -y sudo apt update # Install PHP 8.4 and required extensions sudo apt install -y \\ php8.4 \\ php8.4-fpm \\ php8.4-cli \\ php8.4-common \\ php8.4-curl \\ php8.4-mbstring \\ php8.4-xml \\ php8.4-zip \\ php8.4-pdo \\ php8.4-mysql \\ php8.4-pgsql \\ php8.4-sqlite3 \\ php8.4-intl \\ php8.4-pcntl \\ php8.4-opcache   ","version":"Next","tagName":"h2"},{"title":"Install Database CLI Tools​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#install-database-cli-tools","content":" Databasement requires database CLI tools to perform backup and restore operations.  ","version":"Next","tagName":"h2"},{"title":"For MySQL/MariaDB backups​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#for-mysqlmariadb-backups","content":" # Install MariaDB client (includes mariadb-dump and mariadb commands) sudo apt install -y mariadb-client # Or install MySQL client (includes mysqldump and mysql commands) # sudo apt install -y mysql-client   note By default, Databasement uses MariaDB CLI tools (mariadb-dump, mariadb). If you prefer MySQL tools (mysqldump, mysql), set the environment variable MYSQL_CLI_TYPE=mysql.  ","version":"Next","tagName":"h3"},{"title":"For PostgreSQL backups​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#for-postgresql-backups","content":" # Install PostgreSQL client (includes pg_dump and psql commands) sudo apt install -y postgresql-client   ","version":"Next","tagName":"h3"},{"title":"For SQLite backups​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#for-sqlite-backups","content":" SQLite support is built into PHP - no additional tools needed.  ","version":"Next","tagName":"h3"},{"title":"Install Composer​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#install-composer","content":" curl -sS https://getcomposer.org/installer | php sudo mv composer.phar /usr/local/bin/composer   ","version":"Next","tagName":"h2"},{"title":"Install Node.js​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#install-nodejs","content":" curl -fsSL https://deb.nodesource.com/setup_22.x | sudo -E bash - sudo apt install -y nodejs   ","version":"Next","tagName":"h2"},{"title":"Install Nginx​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#install-nginx","content":" sudo apt install -y nginx   ","version":"Next","tagName":"h2"},{"title":"Download and Configure Databasement​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#download-and-configure-databasement","content":" # Clone the repository cd /var/www/databasement git clone https://github.com/David-Crty/databasement.git . # Install PHP dependencies composer install --no-dev --optimize-autoloader # Install Node dependencies and build assets npm install npm run build # Publish Livewire assets php artisan vendor:publish --force --tag=livewire:assets   ","version":"Next","tagName":"h2"},{"title":"Configure Environment​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#configure-environment","content":" # Generate application key php artisan key:generate   Edit the .env file with your configuration:  nano .env   Essential settings:  APP_ENV=production APP_DEBUG=false APP_URL=https://your-domain.com # Database for Databasement (choose one) # SQLite (simplest) DB_CONNECTION=sqlite DB_DATABASE=/var/www/databasement/database/database.sqlite # Or MySQL # DB_CONNECTION=mysql # DB_HOST=127.0.0.1 # DB_PORT=3306 # DB_DATABASE=databasement # DB_USERNAME=databasement # DB_PASSWORD=your-password # Or PostgreSQL # DB_CONNECTION=pgsql # DB_HOST=127.0.0.1 # DB_PORT=5432 # DB_DATABASE=databasement # DB_USERNAME=databasement # DB_PASSWORD=your-password # Backup working directory BACKUP_WORKING_DIRECTORY=/tmp/backups   For all available environment variables, see the Configuration page.  S3 Storage To store backups in AWS S3 or S3-compatible storage (MinIO, DigitalOcean Spaces, etc.), see the S3 Storage Configuration section.  ","version":"Next","tagName":"h2"},{"title":"Run Database Migrations​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#run-database-migrations","content":" # Run migrations cd /var/www/databasement php artisan migrate --force   ","version":"Next","tagName":"h2"},{"title":"Configure Nginx​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#configure-nginx","content":" Create a new Nginx configuration:  sudo nano /etc/nginx/sites-available/databasement   Add the following configuration:  server { listen 80; server_name your-domain.com; root /var/www/databasement/public; add_header X-Frame-Options &quot;SAMEORIGIN&quot;; add_header X-Content-Type-Options &quot;nosniff&quot;; index index.php; charset utf-8; location / { try_files $uri $uri/ /index.php?$query_string; } location = /favicon.ico { access_log off; log_not_found off; } location = /robots.txt { access_log off; log_not_found off; } error_page 404 /index.php; location ~ \\.php$ { fastcgi_pass unix:/var/run/php/php8.4-fpm.sock; fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name; include fastcgi_params; fastcgi_hide_header X-Powered-By; } location ~ /\\.(?!well-known).* { deny all; } }   Enable the site:  sudo ln -s /etc/nginx/sites-available/databasement /etc/nginx/sites-enabled/ sudo nginx -t sudo systemctl reload nginx   ","version":"Next","tagName":"h2"},{"title":"Configure Queue Worker (Systemd)​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#configure-queue-worker-systemd","content":" The queue worker is required to process backup and restore jobs.  Create a systemd service:  sudo nano /etc/systemd/system/databasement-queue.service   Add the following:  [Unit] Description=Databasement Queue Worker After=network.target [Service] User=www-data Group=www-data Restart=always RestartSec=5 WorkingDirectory=/var/www/databasement ExecStart=/usr/bin/php artisan queue:work --queue=backups,default --tries=3 --timeout=3600 --sleep=3 --max-jobs=1000 [Install] WantedBy=multi-user.target   Enable and start the service:  sudo systemctl daemon-reload sudo systemctl enable databasement-queue sudo systemctl start databasement-queue   Check status:  sudo systemctl status databasement-queue   ","version":"Next","tagName":"h2"},{"title":"Configure Scheduler (Cron)​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#configure-scheduler-cron","content":" The scheduler runs automated backups based on your configured schedules.  crontab -e   Add this line:  * * * * * cd /var/www/databasement &amp;&amp; php artisan schedule:run &gt;&gt; /dev/null 2&gt;&amp;1   ","version":"Next","tagName":"h2"},{"title":"Verification​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#verification","content":" Open your browser and navigate to your domainCreate your first user accountAdd a database server and test the connectionCreate a backup to verify everything works  ","version":"Next","tagName":"h2"},{"title":"Troubleshooting​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#troubleshooting","content":" Check Queue Worker Logs  sudo journalctl -u databasement-queue -f   Check PHP-FPM LogsCheck Nginx Logs  ","version":"Next","tagName":"h2"},{"title":"Test Database CLI Tools​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#test-database-cli-tools","content":" # Test MariaDB/MySQL client mariadb --version # or: mysql --version # Test PostgreSQL client psql --version # Test pg_dump pg_dump --version   ","version":"Next","tagName":"h3"},{"title":"Run Artisan Commands​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#run-artisan-commands","content":" php artisan migrate:status php artisan config:show database   ","version":"Next","tagName":"h3"},{"title":"More troubleshooting​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#more-troubleshooting","content":" For additional troubleshooting options including debug mode and trusted proxy configuration, see the Configuration Troubleshooting section.  ","version":"Next","tagName":"h3"},{"title":"Updating Databasement​","type":1,"pageTitle":"Native Ubuntu Installation","url":"/databasement/self-hosting/native-ubuntu#updating-databasement","content":" # Pull latest changes git pull origin main # Install dependencies composer install --no-dev --optimize-autoloader npm install npm run build # Run migrations php artisan migrate --force # Clear caches php artisan optimize:clear # Restart queue worker sudo systemctl restart databasement-queue  ","version":"Next","tagName":"h2"},{"title":"Storage Volumes","type":0,"sectionRef":"#","url":"/databasement/user-guide/volumes","content":"","keywords":"","version":"Next"},{"title":"Volume Types​","type":1,"pageTitle":"Storage Volumes","url":"/databasement/user-guide/volumes#volume-types","content":" ","version":"Next","tagName":"h2"},{"title":"Local Storage​","type":1,"pageTitle":"Storage Volumes","url":"/databasement/user-guide/volumes#local-storage","content":" Local volumes store backups on the filesystem where Databasement is running. This is the simplest option for single-server setups.  Field\tDescriptionPath\tAbsolute path to the backup directory  info Ensure the Databasement container has write access to the specified path. You may need to mount a volume when running Docker: docker run -v /path/on/host:/backups davidcrty/databasement   ","version":"Next","tagName":"h3"},{"title":"S3 Storage​","type":1,"pageTitle":"Storage Volumes","url":"/databasement/user-guide/volumes#s3-storage","content":" S3 volumes store backups in AWS S3 or any S3-compatible object storage (MinIO, DigitalOcean Spaces, Backblaze B2, etc.).  Field\tDescriptionBucket\tS3 bucket name Prefix\tOptional path prefix within the bucket (e.g., backups/production/)  info S3 credentials are configured via environment variables, not per-volume. See the S3 Storage configuration for setup instructions.  ","version":"Next","tagName":"h3"},{"title":"SFTP Storage​","type":1,"pageTitle":"Storage Volumes","url":"/databasement/user-guide/volumes#sftp-storage","content":" SFTP volumes store backups on a remote server via SSH File Transfer Protocol. This is ideal for storing backups on a dedicated backup server or NAS.  Field\tDescriptionHost\tSFTP server hostname or IP address Port\tSSH port (default: 22) Username\tSSH username Password\tSSH password Root Directory\tBase path on the remote server (e.g., /backups) Connection Timeout\tTimeout in seconds (default: 10)  note Only password authentication is currently supported. SSH key authentication is planned for a future release.  tip The password is encrypted at rest in the database using Laravel's encryption. It is never stored in plain text.  ","version":"Next","tagName":"h3"},{"title":"FTP Storage​","type":1,"pageTitle":"Storage Volumes","url":"/databasement/user-guide/volumes#ftp-storage","content":" FTP volumes store backups on a remote FTP server. Both standard FTP and FTPS (FTP over SSL/TLS) are supported.  Field\tDescriptionHost\tFTP server hostname or IP address Port\tFTP port (default: 21) Username\tFTP username Password\tFTP password Root Directory\tBase path on the remote server (e.g., /backups) Enable SSL\tUse FTPS (FTP over SSL/TLS) for encrypted transfers Passive Mode\tUse passive mode for data connections (recommended for most setups) Connection Timeout\tTimeout in seconds (default: 90)  warning Standard FTP transmits credentials and data in plain text. Enable SSL for secure transfers, or prefer SFTP for better security.  tip The password is encrypted at rest in the database using Laravel's encryption. It is never stored in plain text.  ","version":"Next","tagName":"h3"},{"title":"Connection Testing​","type":1,"pageTitle":"Storage Volumes","url":"/databasement/user-guide/volumes#connection-testing","content":" Before saving a volume, use the Test Connection button to verify:  The storage location is accessibleWrite permissions are configured correctlyCredentials are valid (for SFTP/FTP)  The test creates a small temporary file, reads it back to verify integrity, then deletes it.  ","version":"Next","tagName":"h2"},{"title":"Volume Immutability​","type":1,"pageTitle":"Storage Volumes","url":"/databasement/user-guide/volumes#volume-immutability","content":" Once a volume has backup snapshots associated with it, the storage configuration becomes read-only. This protects backup integrity by ensuring snapshots always point to their original storage location.  You can still rename the volume, but the storage type and configuration cannot be changed. To use different storage settings, create a new volume. ","version":"Next","tagName":"h2"},{"title":"Snapshots","type":0,"sectionRef":"#","url":"/databasement/user-guide/snapshots","content":"","keywords":"","version":"Next"},{"title":"File Verification​","type":1,"pageTitle":"Snapshots","url":"/databasement/user-guide/snapshots#file-verification","content":" Databasement verifies daily that backup files still exist on their storage volumes. Missing files are surfaced on the dashboard and in the jobs index with a &quot;File missing&quot; warning.  You can also trigger verification manually from the dashboard.  See Backup Configuration for BACKUP_VERIFY_FILES and BACKUP_VERIFY_FILES_CRON settings.  ","version":"Next","tagName":"h2"},{"title":"Restore Process​","type":1,"pageTitle":"Snapshots","url":"/databasement/user-guide/snapshots#restore-process","content":" When you restore a snapshot, Databasement:  Downloads the snapshot from storageDecompresses the backup fileConnects to the target database serverDrops and recreates the target database (if it exists)Restores the data using native database tools  ","version":"Next","tagName":"h2"},{"title":"Restore Commands​","type":1,"pageTitle":"Snapshots","url":"/databasement/user-guide/snapshots#restore-commands","content":" MySQL/MariaDB:  mariadb --host='...' --port='...' --user='...' --password='...' --skip_ssl \\ 'database_name' -e &quot;source /path/to/dump.sql&quot;   PostgreSQL:  PGPASSWORD='...' psql --host='...' --port='...' --username='...' \\ 'database_name' -f '/path/to/dump.sql'   SQLite:  cp '/path/to/snapshot' '/path/to/database.sqlite'   All snapshots are decompressed with gzip -d before restore. ","version":"Next","tagName":"h3"},{"title":"Database Servers","type":0,"sectionRef":"#","url":"/databasement/user-guide/database-servers","content":"","keywords":"","version":"Next"},{"title":"Connection Requirements​","type":1,"pageTitle":"Database Servers","url":"/databasement/user-guide/database-servers#connection-requirements","content":" ","version":"Next","tagName":"h2"},{"title":"MySQL / MariaDB​","type":1,"pageTitle":"Database Servers","url":"/databasement/user-guide/database-servers#mysql--mariadb","content":" Creating the user​  CREATE USER 'databasement'@'%' IDENTIFIED BY 'your_secure_password';   Permissions for backup and restore (all databases)​  GRANT SELECT, SHOW VIEW, TRIGGER, LOCK TABLES, PROCESS, EVENT, RELOAD, CREATE, DROP, ALTER, INDEX, INSERT, UPDATE, DELETE, REFERENCES ON *.* TO 'databasement'@'%'; FLUSH PRIVILEGES;   Single database only To restrict the user to a single database, replace *.* with database_name.*. Note that with single-database permissions, the user cannot create or drop the database itself - you'll need to ensure the target database exists before restoring.  ","version":"Next","tagName":"h3"},{"title":"PostgreSQL​","type":1,"pageTitle":"Database Servers","url":"/databasement/user-guide/database-servers#postgresql","content":" Creating the user​  CREATE USER databasement WITH PASSWORD 'your_secure_password';   Permissions for backup and restore (all databases)​  For full backup and restore capabilities, the user needs elevated privileges. The method depends on your PostgreSQL setup:  Self-hosted PostgreSQL​  -- Option 1: Superuser (full access) ALTER USER databasement WITH SUPERUSER; -- Option 2: Create database privilege (can create/drop databases for restore) ALTER USER databasement WITH CREATEDB;   AWS RDS PostgreSQL​  RDS doesn't allow SUPERUSER. Grant the rds_superuser role instead:  GRANT rds_superuser TO databasement;   Azure Database for PostgreSQL​  Azure uses the azure_pg_admin role:  GRANT azure_pg_admin TO databasement;   Additional grants for non-superuser setups​  If not using superuser/rds_superuser/azure_pg_admin, grant access to existing databases:  -- Grant ownership or full privileges on the database GRANT ALL PRIVILEGES ON DATABASE database_name TO databasement; -- Connect to the database and grant schema access \\c database_name GRANT ALL PRIVILEGES ON SCHEMA public TO databasement; GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO databasement; ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT ALL ON TABLES TO databasement;   Single database only For single-database access without CREATEDB, the target database must already exist. Grant ALL PRIVILEGES on that specific database and its schema. The user won't be able to drop/recreate the database during restore - Databasement will drop and recreate tables instead.  ","version":"Next","tagName":"h3"},{"title":"Troubleshooting Connection Issues​","type":1,"pageTitle":"Database Servers","url":"/databasement/user-guide/database-servers#troubleshooting-connection-issues","content":" ","version":"Next","tagName":"h2"},{"title":"Common Connection Issues​","type":1,"pageTitle":"Database Servers","url":"/databasement/user-guide/database-servers#common-connection-issues","content":" Error\tSolutionConnection refused\tVerify host, port, and that the database server is running Access denied\tCheck username and password Unknown host\tVerify the hostname is correct and DNS is resolving Connection timeout\tCheck firewall rules and network connectivity  ","version":"Next","tagName":"h3"},{"title":"Docker Networking​","type":1,"pageTitle":"Database Servers","url":"/databasement/user-guide/database-servers#docker-networking","content":" When running Databasement in Docker and connecting to databases in other containers, you need to ensure network connectivity between them.  Containers in Different docker-compose Projects​  By default, each docker-compose project creates its own isolated network. To connect to a database in another project:  Option 1: Use an external network (recommended)  Create a shared network: docker network create shared-db-network In your application database's docker-compose.yml, add the external network: services: mysql: # ... your config networks: - default - shared-db-network networks: shared-db-network: external: true In Databasement's docker-compose.yml, add the same network: services: app: # ... your config networks: - default - shared-db-network worker: # ... your config networks: - default - shared-db-network networks: shared-db-network: external: true Restart both projects and use the container name as the host (e.g., mysql).  Option 2: Connect to an existing network  Find the network name of your database container:  docker network ls docker inspect &lt;container_name&gt; | grep -A 20 &quot;Networks&quot;   Then connect Databasement to that network:  networks: other-project_default: external: true   Standalone Docker Containers (no docker-compose)​  For containers started with docker run:  Create a network if you don't have one: docker network create my-network Start your database container on that network: docker run -d --name mysql --network my-network mysql:8 Connect Databasement to the same network: docker network connect my-network databasement-app Use the container name (mysql) as the host in Databasement.  Using Host Network Mode​  If your database is accessible on the host machine (e.g., installed directly or exposed via port mapping), you can use host network mode:  services: app: network_mode: host   Then use localhost or 127.0.0.1 as the host. Note that this disables Docker's network isolation.  Connecting to Host Machine's Database​  If your database runs directly on the host machine (not in Docker):  Platform\tHost to useLinux\t172.17.0.1 or host.docker.internal (Docker 20.10+) macOS/Windows\thost.docker.internal  Example: If MySQL is running on your laptop on port 3306, use host.docker.internal:3306.  ","version":"Next","tagName":"h3"},{"title":"Firewall Considerations​","type":1,"pageTitle":"Database Servers","url":"/databasement/user-guide/database-servers#firewall-considerations","content":" Ensure your firewall allows connections:  Docker networks: Usually handled automaticallyHost firewall (iptables/ufw): May need rules for Docker bridge networksCloud firewalls (AWS Security Groups, etc.): Add inbound rules for the database port  ","version":"Next","tagName":"h3"},{"title":"SSH Tunnel​","type":1,"pageTitle":"Database Servers","url":"/databasement/user-guide/database-servers#ssh-tunnel","content":" Connect to databases in private networks through a bastion/jump server. Enable this when the database isn't directly accessible from Databasement.  Field\tDescriptionSSH Host\tBastion server hostname or IP SSH Port\tSSH port (default: 22) SSH Username\tSSH user Auth Type\tPassword or Private Key (with optional passphrase)  Databasement establishes the tunnel before each backup/restore operation and closes it when complete. Sensitive credentials are encrypted at rest. ","version":"Next","tagName":"h2"}],"options":{"id":"default"}}