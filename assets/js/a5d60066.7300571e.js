"use strict";(globalThis.webpackChunkdatabasement_docs=globalThis.webpackChunkdatabasement_docs||[]).push([[659],{2293:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"self-hosting/configuration/sso","title":"SSO","description":"Databasement supports OAuth authentication, allowing users to log in using external identity providers. This can be used alongside or instead of traditional password authentication.","source":"@site/docs/self-hosting/configuration/sso.md","sourceDirName":"self-hosting/configuration","slug":"/self-hosting/configuration/sso","permalink":"/databasement/self-hosting/configuration/sso","draft":false,"unlisted":false,"editUrl":"https://github.com/David-Crty/databasement/tree/main/docs/docs/self-hosting/configuration/sso.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"selfHostingSidebar","previous":{"title":"Notification","permalink":"/databasement/self-hosting/configuration/notification"},"next":{"title":"Docker","permalink":"/databasement/self-hosting/docker"}}');var s=t(4848),r=t(8453);const l={sidebar_position:5},o="SSO",a={},d=[{value:"Supported Providers",id:"supported-providers",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Google",id:"google",level:3},{value:"GitHub",id:"github",level:3},{value:"GitLab",id:"gitlab",level:3},{value:"Generic OIDC (Keycloak, Authentik, etc.)",id:"generic-oidc-keycloak-authentik-etc",level:3},{value:"Keycloak Setup",id:"keycloak-setup",level:4},{value:"Authentik Example",id:"authentik-example",level:4},{value:"User Creation Settings",id:"user-creation-settings",level:2},{value:"Auto-Create Users",id:"auto-create-users",level:3},{value:"Default Role",id:"default-role",level:3},{value:"Auto-Link by Email",id:"auto-link-by-email",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"sso",children:"SSO"})}),"\n",(0,s.jsx)(n.p,{children:"Databasement supports OAuth authentication, allowing users to log in using external identity providers. This can be used alongside or instead of traditional password authentication."}),"\n",(0,s.jsx)(n.h2,{id:"supported-providers",children:"Supported Providers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Google"})," - Google Workspace and personal accounts"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"GitHub"})," - GitHub accounts"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"GitLab"})," - GitLab.com or self-hosted GitLab"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Generic OIDC"})," - Any OpenID Connect provider (Keycloak, Authentik, Dex, Okta, etc.)"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{title:"Need another provider?",type:"tip",children:(0,s.jsxs)(n.p,{children:["Laravel Socialite supports ",(0,s.jsx)(n.a,{href:"https://socialiteproviders.com/",children:"many more providers"})," including Facebook, Microsoft, Apple, Slack, and 100+ others. Feel free to submit a PR to add support for additional providers."]})}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.p,{children:"OAuth is configured via environment variables. Each provider can be enabled independently."}),"\n",(0,s.jsx)(n.h3,{id:"google",children:"Google"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Create OAuth credentials in ",(0,s.jsx)(n.a,{href:"https://console.cloud.google.com/apis/credentials",children:"Google Cloud Console"})]}),"\n",(0,s.jsxs)(n.li,{children:["Set authorized redirect URI to: ",(0,s.jsx)(n.code,{children:"https://your-domain.com/oauth/google/callback"})]}),"\n",(0,s.jsx)(n.li,{children:"Configure environment variables:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-env",children:"OAUTH_GOOGLE_ENABLED=true\nOAUTH_GOOGLE_CLIENT_ID=your-client-id\nOAUTH_GOOGLE_CLIENT_SECRET=your-client-secret\n"})}),"\n",(0,s.jsx)(n.h3,{id:"github",children:"GitHub"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Create an OAuth App in ",(0,s.jsx)(n.a,{href:"https://github.com/settings/developers",children:"GitHub Developer Settings"})]}),"\n",(0,s.jsxs)(n.li,{children:["Set authorization callback URL to: ",(0,s.jsx)(n.code,{children:"https://your-domain.com/oauth/github/callback"})]}),"\n",(0,s.jsx)(n.li,{children:"Configure environment variables:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-env",children:"OAUTH_GITHUB_ENABLED=true\nOAUTH_GITHUB_CLIENT_ID=your-client-id\nOAUTH_GITHUB_CLIENT_SECRET=your-client-secret\n"})}),"\n",(0,s.jsx)(n.h3,{id:"gitlab",children:"GitLab"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Create an OAuth application in GitLab (Admin Area > Applications or User Settings > Applications)"}),"\n",(0,s.jsxs)(n.li,{children:["Set redirect URI to: ",(0,s.jsx)(n.code,{children:"https://your-domain.com/oauth/gitlab/callback"})]}),"\n",(0,s.jsx)(n.li,{children:"Configure environment variables:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-env",children:"OAUTH_GITLAB_ENABLED=true\nOAUTH_GITLAB_CLIENT_ID=your-application-id\nOAUTH_GITLAB_CLIENT_SECRET=your-secret\nOAUTH_GITLAB_HOST=https://gitlab.com  # Or your self-hosted GitLab URL\n"})}),"\n",(0,s.jsx)(n.h3,{id:"generic-oidc-keycloak-authentik-etc",children:"Generic OIDC (Keycloak, Authentik, etc.)"}),"\n",(0,s.jsx)(n.p,{children:"For any OpenID Connect compatible provider:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Create a client/application in your identity provider"}),"\n",(0,s.jsxs)(n.li,{children:["Set redirect URI to: ",(0,s.jsx)(n.code,{children:"https://your-domain.com/oauth/oidc/callback"})]}),"\n",(0,s.jsx)(n.li,{children:"Configure environment variables:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-env",children:"OAUTH_OIDC_ENABLED=true\nOAUTH_OIDC_CLIENT_ID=your-client-id\nOAUTH_OIDC_CLIENT_SECRET=your-client-secret\nOAUTH_OIDC_BASE_URL=https://your-idp.com/realms/your-realm  # The OIDC base URL\nOAUTH_OIDC_LABEL=SSO  # Button label on login page\n"})}),"\n",(0,s.jsx)(n.h4,{id:"keycloak-setup",children:"Keycloak Setup"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In Keycloak Admin Console, go to ",(0,s.jsx)(n.strong,{children:"Clients"})," and click ",(0,s.jsx)(n.strong,{children:"Create client"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Configure the client:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Client ID"}),": ",(0,s.jsx)(n.code,{children:"databasement"})," (or your preferred name)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Client authentication"}),": ",(0,s.jsx)(n.strong,{children:"On"})," (required for confidential clients)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Authentication flow"}),": Check ",(0,s.jsx)(n.strong,{children:"Standard flow"})," (Authorization Code Flow)"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.strong,{children:"Settings"})," tab, configure the URLs (replace ",(0,s.jsx)(n.code,{children:"databasement.example.com"})," with your domain):"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Field"}),(0,s.jsx)(n.th,{children:"Value"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Root URL"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://databasement.example.com"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Home URL"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://databasement.example.com"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Valid redirect URIs"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://databasement.example.com/oauth/oidc/callback"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Valid post logout redirect URIs"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://databasement.example.com"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Web origins"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"https://databasement.example.com"})})]})]})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Go to the ",(0,s.jsx)(n.strong,{children:"Credentials"})," tab and copy the ",(0,s.jsx)(n.strong,{children:"Client secret"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Configure environment variables:"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-env",children:"OAUTH_OIDC_ENABLED=true\nOAUTH_OIDC_CLIENT_ID=databasement\nOAUTH_OIDC_CLIENT_SECRET=your-client-secret\nOAUTH_OIDC_BASE_URL=https://keycloak.example.com/realms/your-realm\nOAUTH_OIDC_LABEL=Keycloak\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Finding the Issuer URL",type:"tip",children:(0,s.jsxs)(n.p,{children:["The issuer URL follows the pattern ",(0,s.jsx)(n.code,{children:"https://your-keycloak-server/realms/your-realm-name"}),". You can find it in ",(0,s.jsx)(n.strong,{children:"Realm Settings"})," > ",(0,s.jsx)(n.strong,{children:"General"})," > ",(0,s.jsx)(n.strong,{children:"Endpoints"})," > ",(0,s.jsx)(n.strong,{children:"OpenID Endpoint Configuration"}),"."]})}),"\n",(0,s.jsx)(n.h4,{id:"authentik-example",children:"Authentik Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-env",children:"OAUTH_OIDC_ENABLED=true\nOAUTH_OIDC_CLIENT_ID=databasement\nOAUTH_OIDC_CLIENT_SECRET=your-secret\nOAUTH_OIDC_BASE_URL=https://authentik.example.com/application/o/databasement/\nOAUTH_OIDC_LABEL=Authentik\n"})}),"\n",(0,s.jsx)(n.h2,{id:"user-creation-settings",children:"User Creation Settings"}),"\n",(0,s.jsx)(n.h3,{id:"auto-create-users",children:"Auto-Create Users"}),"\n",(0,s.jsx)(n.p,{children:"When enabled (default), new users are automatically created when they log in via OAuth for the first time:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-env",children:"OAUTH_AUTO_CREATE_USERS=true  # Default: true\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Set to ",(0,s.jsx)(n.code,{children:"false"})," to only allow existing users to log in via OAuth."]}),"\n",(0,s.jsx)(n.h3,{id:"default-role",children:"Default Role"}),"\n",(0,s.jsx)(n.p,{children:"New users created via OAuth are assigned this role:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-env",children:"OAUTH_DEFAULT_ROLE=member  # Options: viewer, member, admin\n"})}),"\n",(0,s.jsx)(n.h3,{id:"auto-link-by-email",children:"Auto-Link by Email"}),"\n",(0,s.jsx)(n.p,{children:"When enabled (default), OAuth logins are automatically linked to existing users with matching email addresses:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-env",children:"OAUTH_AUTO_LINK_BY_EMAIL=true  # Default: true\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For local development OAuth testing, see the ",(0,s.jsx)(n.a,{href:"/contributing/development#oauth--sso-testing",children:"Development Guide"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>o});var i=t(6540);const s={},r=i.createContext(s);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);