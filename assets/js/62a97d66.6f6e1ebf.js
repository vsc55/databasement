"use strict";(globalThis.webpackChunkdatabasement_docs=globalThis.webpackChunkdatabasement_docs||[]).push([[356],{8453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>l});var r=n(6540);const t={},i=r.createContext(t);function a(e){const s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(i.Provider,{value:s},e.children)}},9629:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"user-guide/backups","title":"Backups","description":"Databasement allows you to create on-demand backups of your databases. Backups are processed asynchronously, so you can continue using the application while they run.","source":"@site/docs/user-guide/backups.md","sourceDirName":"user-guide","slug":"/user-guide/backups","permalink":"/databasement/user-guide/backups","draft":false,"unlisted":false,"editUrl":"https://github.com/David-Crty/databasement/tree/main/docs/docs/user-guide/backups.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"userGuideSidebar","previous":{"title":"Database Servers","permalink":"/databasement/user-guide/database-servers"},"next":{"title":"Snapshots","permalink":"/databasement/user-guide/snapshots"}}');var t=n(4848),i=n(8453);const a={sidebar_position:3},l="Backups",d={},o=[{value:"How Backups Work",id:"how-backups-work",level:2},{value:"Backup Commands",id:"backup-commands",level:3},{value:"Failed Backups",id:"failed-backups",level:2},{value:"Retention Policies",id:"retention-policies",level:2},{value:"Simple (Days-Based)",id:"simple-days-based",level:3},{value:"GFS (Grandfather-Father-Son)",id:"gfs-grandfather-father-son",level:3},{value:"Choosing a Retention Policy",id:"choosing-a-retention-policy",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Before Production Backups",id:"before-production-backups",level:3},{value:"Backup Sizing",id:"backup-sizing",level:3},{value:"Security Considerations",id:"security-considerations",level:3}];function c(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"backups",children:"Backups"})}),"\n",(0,t.jsx)(s.p,{children:"Databasement allows you to create on-demand backups of your databases. Backups are processed asynchronously, so you can continue using the application while they run."}),"\n",(0,t.jsx)(s.h2,{id:"how-backups-work",children:"How Backups Work"}),"\n",(0,t.jsx)(s.p,{children:"When you create a backup, Databasement:"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"Connects to the database server"}),"\n",(0,t.jsxs)(s.li,{children:["Runs the appropriate dump command (",(0,t.jsx)(s.code,{children:"mysqldump"})," or ",(0,t.jsx)(s.code,{children:"pg_dump"}),")"]}),"\n",(0,t.jsx)(s.li,{children:"Compresses the output with gzip"}),"\n",(0,t.jsx)(s.li,{children:"Transfers the compressed file to the selected storage volume"}),"\n",(0,t.jsx)(s.li,{children:"Creates a snapshot record with metadata"}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"backup-commands",children:"Backup Commands"}),"\n",(0,t.jsx)(s.p,{children:"Databasement uses native database tools for reliable backups:"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"MySQL/MariaDB:"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"mariadb-dump --routines --add-drop-table --complete-insert --hex-blob --quote-names --skip_ssl \\\n  --host='...' --port='...' --user='...' --password='...' 'database_name' > dump.sql\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"PostgreSQL:"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"PGPASSWORD='...' pg_dump --clean --if-exists --no-owner --no-privileges --quote-all-identifiers \\\n  --host='...' --port='...' --username='...' 'database_name' -f dump.sql\n"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"SQLite:"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"cp '/path/to/database.sqlite' dump.db\n"})}),"\n",(0,t.jsx)(s.p,{children:"All dumps are then compressed with gzip before being transferred to the storage volume."}),"\n",(0,t.jsx)(s.h2,{id:"failed-backups",children:"Failed Backups"}),"\n",(0,t.jsx)(s.p,{children:"If a backup fails, check:"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Database connectivity"}),": Can Databasement still connect to the server?"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Disk space"}),": Is there enough space on the storage volume?"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Permissions"}),": Does the database user have backup privileges?"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Timeout"}),": Large databases may need more time"]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Failed backup reasons are logged and visible in the snapshot details."}),"\n",(0,t.jsx)(s.h2,{id:"retention-policies",children:"Retention Policies"}),"\n",(0,t.jsx)(s.p,{children:"Retention policies control how long backups are kept before being automatically deleted. Databasement offers two retention strategies:"}),"\n",(0,t.jsx)(s.h3,{id:"simple-days-based",children:"Simple (Days-Based)"}),"\n",(0,t.jsx)(s.p,{children:"The simplest option: keep all backups for a specified number of days."}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Example:"})," With ",(0,t.jsx)(s.code,{children:"retention_days = 30"}),", any backup older than 30 days is automatically deleted."]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Day"}),(0,t.jsx)(s.th,{children:"Backups Kept"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"1-30"}),(0,t.jsx)(s.td,{children:"All backups"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"31+"}),(0,t.jsx)(s.td,{children:"Deleted"})]})]})]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Best for:"})," Short-term backup needs, development environments, or when storage cost isn't a concern."]}),"\n",(0,t.jsx)(s.h3,{id:"gfs-grandfather-father-son",children:"GFS (Grandfather-Father-Son)"}),"\n",(0,t.jsx)(s.p,{children:"A tiered retention strategy that keeps recent backups for quick recovery while preserving older snapshots for long-term archival \u2014 without keeping every single backup."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"How it works:"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Tier"}),(0,t.jsx)(s.th,{children:"What it keeps"}),(0,t.jsx)(s.th,{children:"Example"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.strong,{children:"Daily"})," (Son)"]}),(0,t.jsx)(s.td,{children:"The N most recent backups"}),(0,t.jsx)(s.td,{children:"Keep last 7 backups"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.strong,{children:"Weekly"})," (Father)"]}),(0,t.jsx)(s.td,{children:"1 backup per week for N weeks"}),(0,t.jsx)(s.td,{children:"Keep 1/week for 4 weeks"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.strong,{children:"Monthly"})," (Grandfather)"]}),(0,t.jsx)(s.td,{children:"1 backup per month for N months"}),(0,t.jsx)(s.td,{children:"Keep 1/month for 12 months"})]})]})]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Example with default values (7 daily, 4 weekly, 12 monthly):"})}),"\n",(0,t.jsx)(s.p,{children:"After running daily backups for a year, you'll have approximately:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"7 recent backups"})," (last 7 days)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"4 weekly backups"})," (one from each of the past 4 weeks)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"12 monthly backups"})," (one from each of the past 12 months)"]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Total: ~23 backups"})," instead of 365 \u2014 saving significant storage while maintaining recovery points across the entire year."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"Timeline visualization:\n\nToday \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 1 year ago\n  \u2502                                                        \u2502\n  \u251c\u2500\u2500 Daily \u2500\u2500\u2524 (7 backups)                                \u2502\n  \u2502           \u2502                                            \u2502\n  \u251c\u2500\u2500 Weekly \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 (4 backups)                        \u2502\n  \u2502                   \u2502                                    \u2502\n  \u2514\u2500\u2500 Monthly \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 (12 backups)\n"})}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Best for:"})," Production environments, compliance requirements, or when you need long-term recovery options without excessive storage costs."]}),"\n",(0,t.jsx)(s.admonition,{title:"Per-Database Retention",type:"info",children:(0,t.jsxs)(s.p,{children:["Retention policies are applied ",(0,t.jsx)(s.strong,{children:"per database"}),", not per server. If you backup 3 databases with GFS (7 daily), each database keeps its own 7 most recent backups \u2014 totaling 21 backups across all databases."]})}),"\n",(0,t.jsx)(s.h3,{id:"choosing-a-retention-policy",children:"Choosing a Retention Policy"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Scenario"}),(0,t.jsx)(s.th,{children:"Recommended Policy"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Development/testing"}),(0,t.jsx)(s.td,{children:"Simple: 7-14 days"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Small production app"}),(0,t.jsx)(s.td,{children:"Simple: 30 days"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Business-critical data"}),(0,t.jsx)(s.td,{children:"GFS: 7d/4w/12m"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Compliance requirements"}),(0,t.jsx)(s.td,{children:"GFS: 14d/8w/24m"})]})]})]}),"\n",(0,t.jsx)(s.admonition,{type:"tip",children:(0,t.jsx)(s.p,{children:'You can disable any GFS tier by leaving it empty. For example, setting only "Monthly: 12" keeps just one backup per month for a year.'})}),"\n",(0,t.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(s.h3,{id:"before-production-backups",children:"Before Production Backups"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Test the connection"})," before creating backups"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Verify restore"})," by testing a restore to a development server"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Monitor disk space"})," on your storage volumes"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"backup-sizing",children:"Backup Sizing"}),"\n",(0,t.jsx)(s.p,{children:"Compressed backup sizes vary, but as a rough guide:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"A 1GB database typically compresses to 100-300MB"}),"\n",(0,t.jsx)(s.li,{children:"Text-heavy data compresses better than binary data"}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Use dedicated backup users with minimal required privileges"}),"\n",(0,t.jsx)(s.li,{children:"Store backups in secure, encrypted storage when possible"}),"\n",(0,t.jsx)(s.li,{children:"Regularly test your restore process"}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);