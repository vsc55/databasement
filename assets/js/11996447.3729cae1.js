"use strict";(globalThis.webpackChunkdatabasement_docs=globalThis.webpackChunkdatabasement_docs||[]).push([[850],{2337:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"contributing/development","title":"Development Guide","description":"This guide covers setting up a local development environment for contributing to Databasement.","source":"@site/docs/contributing/development.md","sourceDirName":"contributing","slug":"/contributing/development","permalink":"/databasement/contributing/development","draft":false,"unlisted":false,"editUrl":"https://github.com/David-Crty/databasement/tree/main/docs/docs/contributing/development.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"contributingSidebar"}');var t=s(4848),r=s(8453);const l={sidebar_position:1},a="Development Guide",o={},d=[{value:"Requirements",id:"requirements",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"1. Clone and Setup",id:"1-clone-and-setup",level:3},{value:"2. Start Development Environment",id:"2-start-development-environment",level:3},{value:"Available Commands",id:"available-commands",level:2},{value:"Testing",id:"testing",level:3},{value:"Code Quality",id:"code-quality",level:3},{value:"Database",id:"database",level:3},{value:"Assets",id:"assets",level:3},{value:"Docker Services",id:"docker-services",level:3},{value:"Git Hooks",id:"git-hooks",level:2},{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"Tech Stack",id:"tech-stack",level:3},{value:"Key Models",id:"key-models",level:3},{value:"Key Services",id:"key-services",level:3},{value:"Livewire Components",id:"livewire-components",level:3},{value:"Backup &amp; Restore Workflow",id:"backup--restore-workflow",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Testing Strategy",id:"testing-strategy",level:2},{value:"What to Test",id:"what-to-test",level:3},{value:"What NOT to Test",id:"what-not-to-test",level:3},{value:"Submitting Changes",id:"submitting-changes",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"development-guide",children:"Development Guide"})}),"\n",(0,t.jsx)(n.p,{children:"This guide covers setting up a local development environment for contributing to Databasement."}),"\n",(0,t.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"PHP 8.4+"}),"\n",(0,t.jsx)(n.li,{children:"Composer"}),"\n",(0,t.jsx)(n.li,{children:"Node.js 20+ & npm"}),"\n",(0,t.jsx)(n.li,{children:"Docker & Docker Compose"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,t.jsx)(n.h3,{id:"1-clone-and-setup",children:"1. Clone and Setup"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/David-Crty/databasement.git\ncd databasement\nmake setup\n"})}),"\n",(0,t.jsx)(n.p,{children:"This will:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Install Composer dependencies"}),"\n",(0,t.jsx)(n.li,{children:"Install npm dependencies"}),"\n",(0,t.jsxs)(n.li,{children:["Copy ",(0,t.jsx)(n.code,{children:".env.example"})," to ",(0,t.jsx)(n.code,{children:".env"})]}),"\n",(0,t.jsx)(n.li,{children:"Generate application key"}),"\n",(0,t.jsx)(n.li,{children:"Run database migrations"}),"\n",(0,t.jsx)(n.li,{children:"Build frontend assets"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"2-start-development-environment",children:"2. Start Development Environment"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"make start\n"})}),"\n",(0,t.jsx)(n.p,{children:"This starts all Docker services:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"php"})," \u2014 FrankenPHP server on ",(0,t.jsx)(n.a,{href:"http://localhost:8081",children:"http://localhost:8081"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"queue"})," \u2014 Queue worker for async backup/restore jobs"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"mysql"})," \u2014 MySQL 8.0 on port 3306"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"postgres"})," \u2014 PostgreSQL 16 on port 5432"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Test database credentials: ",(0,t.jsx)(n.code,{children:"admin"})," / ",(0,t.jsx)(n.code,{children:"admin"})," / ",(0,t.jsx)(n.code,{children:"testdb"})]}),"\n",(0,t.jsx)(n.h2,{id:"available-commands",children:"Available Commands"}),"\n",(0,t.jsxs)(n.p,{children:["All PHP commands run through Docker. Use the Makefile targets or ",(0,t.jsx)(n.code,{children:"docker compose exec app <command>"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"testing",children:"Testing"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"make test                           # Run all tests\nmake test-filter FILTER=ServerTest  # Run specific tests\nmake test-coverage                  # Run with coverage report\nmake backup-test                    # End-to-end backup/restore tests\n"})}),"\n",(0,t.jsx)(n.admonition,{title:"Important",type:"warning",children:(0,t.jsxs)(n.p,{children:["When modifying backup or restore logic in ",(0,t.jsx)(n.code,{children:"app/Services/Backup/"}),", always run ",(0,t.jsx)(n.code,{children:"make backup-test"})," to verify the complete workflow with real database servers."]})}),"\n",(0,t.jsx)(n.h3,{id:"code-quality",children:"Code Quality"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"make lint-fix     # Auto-fix code style with Laravel Pint\nmake lint-check   # Check code style without fixing\nmake phpstan      # Run PHPStan static analysis\n"})}),"\n",(0,t.jsx)(n.h3,{id:"database",children:"Database"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"make migrate            # Run pending migrations\nmake migrate-fresh      # Drop all tables and re-migrate\nmake migrate-fresh-seed # Fresh migration with seeders\nmake db-seed            # Run database seeders\n"})}),"\n",(0,t.jsx)(n.h3,{id:"assets",children:"Assets"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"npm run build   # Build production assets\nnpm run dev     # Start Vite dev server (HMR)\nmake build      # Alternative: build via Makefile\n"})}),"\n",(0,t.jsx)(n.h3,{id:"docker-services",children:"Docker Services"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"make start                    # Start all services\ndocker compose logs -f        # View logs from all services\ndocker compose logs -f queue  # View queue worker logs\ndocker compose restart queue  # Restart queue worker\ndocker compose down           # Stop all services\n"})}),"\n",(0,t.jsx)(n.h2,{id:"git-hooks",children:"Git Hooks"}),"\n",(0,t.jsx)(n.p,{children:"Pre-commit hooks (via Husky) automatically run:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"make lint-fix"})," \u2014 Auto-format code with Laravel Pint"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"make test"})," \u2014 Run all Pest tests"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Ensure tests pass before committing."}),"\n",(0,t.jsx)(n.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,t.jsx)(n.h3,{id:"tech-stack",children:"Tech Stack"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Layer"}),(0,t.jsx)(n.th,{children:"Technology"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Backend"}),(0,t.jsx)(n.td,{children:"Laravel 12, PHP 8.4+"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Frontend"}),(0,t.jsx)(n.td,{children:"Livewire, Mary UI, daisyUI, Tailwind CSS 4"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Testing"}),(0,t.jsx)(n.td,{children:"Pest PHP"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Database"}),(0,t.jsx)(n.td,{children:"SQLite (dev), supports MySQL/PostgreSQL/MariaDB"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Auth"}),(0,t.jsx)(n.td,{children:"Laravel Fortify with 2FA support"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"key-models",children:"Key Models"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"DatabaseServer"})," \u2014 Database connection configurations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Volume"})," \u2014 Storage destinations (local, S3)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Backup"})," \u2014 Backup configurations (schedule, retention, volume)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Snapshot"})," \u2014 Individual backup snapshots with metadata"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"BackupJob"})," \u2014 Tracks backup/restore job execution and logs"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"key-services",children:"Key Services"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"BackupTask"})," \u2014 Executes database dumps, compression, and storage"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"RestoreTask"})," \u2014 Downloads, decompresses, and restores snapshots"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"DatabaseListService"})," \u2014 Lists databases for autocomplete"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"DatabaseConnectionTester"})," \u2014 Validates database connectivity"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"ShellProcessor"})," \u2014 Executes shell commands with logging"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"livewire-components",children:"Livewire Components"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"DatabaseServer/*"})," \u2014 CRUD operations for database servers"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Volume/*"})," \u2014 CRUD operations for storage volumes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"BackupJob/Index"})," \u2014 Job listing with logs modal"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Snapshot/Index"})," \u2014 Snapshot listing and management"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Settings/*"})," \u2014 User settings (Profile, Password, TwoFactor)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"RestoreModal"})," \u2014 3-step wizard for snapshot restoration"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"backup--restore-workflow",children:"Backup & Restore Workflow"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Backup Process:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Connect to database server"}),"\n",(0,t.jsx)(n.li,{children:"Execute database-specific dump (mysqldump/pg_dump)"}),"\n",(0,t.jsx)(n.li,{children:"Compress with gzip"}),"\n",(0,t.jsx)(n.li,{children:"Upload to configured volume (local/S3)"}),"\n",(0,t.jsx)(n.li,{children:"Record snapshot metadata"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Restore Process:"})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Select source snapshot"}),"\n",(0,t.jsx)(n.li,{children:"Download and decompress"}),"\n",(0,t.jsx)(n.li,{children:"Validate compatibility (database types must match)"}),"\n",(0,t.jsx)(n.li,{children:"Drop and recreate target database"}),"\n",(0,t.jsx)(n.li,{children:"Restore SQL dump"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Cross-Server Restore:"})," Restore production snapshots to staging/preprod as long as database types match."]}),"\n",(0,t.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,t.jsxs)(n.p,{children:["Key development configuration in ",(0,t.jsx)(n.code,{children:".env"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-env",children:"# Application\nAPP_URL=http://localhost:8081\n\n# Database (for application data)\nDB_CONNECTION=sqlite\n\n# Queue\nQUEUE_CONNECTION=database\n\n# AWS S3 (optional, for S3 volume testing)\nAWS_ACCESS_KEY_ID=\nAWS_SECRET_ACCESS_KEY=\nAWS_DEFAULT_REGION=us-east-1\n"})}),"\n",(0,t.jsx)(n.h2,{id:"testing-strategy",children:"Testing Strategy"}),"\n",(0,t.jsx)(n.p,{children:"We use Pest PHP for testing. Key principles:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Test business logic and behaviors"})," \u2014 Not framework internals"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Mock external services"})," \u2014 AWS SDK, S3 client, etc."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Don't mock models"})," \u2014 Use real database interactions"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"what-to-test",children:"What to Test"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Authorization (who can access what)"}),"\n",(0,t.jsx)(n.li,{children:"Business logic (backup works, restore works, cleanup deletes correct snapshots)"}),"\n",(0,t.jsx)(n.li,{children:"Integration points (external services, commands)"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"what-not-to-test",children:"What NOT to Test"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Form validation rules (Laravel handles this)"}),"\n",(0,t.jsx)(n.li,{children:"Eloquent relationships and cascades"}),"\n",(0,t.jsx)(n.li,{children:"Session flash messages"}),"\n",(0,t.jsx)(n.li,{children:"Framework behavior"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"submitting-changes",children:"Submitting Changes"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Create a feature branch from ",(0,t.jsx)(n.code,{children:"main"})]}),"\n",(0,t.jsx)(n.li,{children:"Write tests for new functionality"}),"\n",(0,t.jsxs)(n.li,{children:["Ensure all tests pass: ",(0,t.jsx)(n.code,{children:"make test"})]}),"\n",(0,t.jsxs)(n.li,{children:["Run code quality checks: ",(0,t.jsx)(n.code,{children:"make lint-fix && make phpstan"})]}),"\n",(0,t.jsx)(n.li,{children:"Submit a pull request with a clear description"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"For significant changes, open an issue first to discuss the approach."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var i=s(6540);const t={},r=i.createContext(t);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);