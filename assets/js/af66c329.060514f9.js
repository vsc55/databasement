"use strict";(globalThis.webpackChunkdatabasement_docs=globalThis.webpackChunkdatabasement_docs||[]).push([[823],{105:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>u,frontMatter:()=>l,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"self-hosting/native-ubuntu","title":"Native Ubuntu Installation","description":"This guide will help you install Databasement directly on Ubuntu without Docker. This is useful for environments where Docker is not available or when you prefer a traditional installation.","source":"@site/docs/self-hosting/native-ubuntu.md","sourceDirName":"self-hosting","slug":"/self-hosting/native-ubuntu","permalink":"/databasement/self-hosting/native-ubuntu","draft":false,"unlisted":false,"editUrl":"https://github.com/David-Crty/databasement/tree/main/docs/docs/self-hosting/native-ubuntu.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"selfHostingSidebar","previous":{"title":"Kubernetes + Helm","permalink":"/databasement/self-hosting/kubernetes-helm"}}');var t=s(4848),i=s(8453);const l={sidebar_position:6},r="Native Ubuntu Installation",o={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Install PHP 8.4",id:"install-php-84",level:2},{value:"Install Database CLI Tools",id:"install-database-cli-tools",level:2},{value:"For MySQL/MariaDB backups",id:"for-mysqlmariadb-backups",level:3},{value:"For PostgreSQL backups",id:"for-postgresql-backups",level:3},{value:"For SQLite backups",id:"for-sqlite-backups",level:3},{value:"Install Composer",id:"install-composer",level:2},{value:"Install Node.js",id:"install-nodejs",level:2},{value:"Install Nginx",id:"install-nginx",level:2},{value:"Step 6: Download and Configure Databasement",id:"step-6-download-and-configure-databasement",level:2},{value:"Configure Environment",id:"configure-environment",level:2},{value:"Run Database Migrations",id:"run-database-migrations",level:2},{value:"Step 10: Configure Nginx",id:"step-10-configure-nginx",level:2},{value:"Step 9: Configure Queue Worker (Systemd)",id:"step-9-configure-queue-worker-systemd",level:2},{value:"Configure Scheduler (Cron)",id:"configure-scheduler-cron",level:2},{value:"Verification",id:"verification",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Test Database CLI Tools",id:"test-database-cli-tools",level:3},{value:"Run Artisan Commands",id:"run-artisan-commands",level:3},{value:"Updating Databasement",id:"updating-databasement",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"native-ubuntu-installation",children:"Native Ubuntu Installation"})}),"\n",(0,t.jsx)(n.p,{children:"This guide will help you install Databasement directly on Ubuntu without Docker. This is useful for environments where Docker is not available or when you prefer a traditional installation."}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Ubuntu 22.04 LTS or 24.04 LTS"}),"\n",(0,t.jsx)(n.li,{children:"Root or sudo access"}),"\n",(0,t.jsx)(n.li,{children:"A web server (Nginx or Apache)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"install-php-84",children:"Install PHP 8.4"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Add PHP repository\nsudo add-apt-repository ppa:ondrej/php -y\nsudo apt update\n\n# Install PHP 8.4 and required extensions\nsudo apt install -y \\\n    php8.4 \\\n    php8.4-fpm \\\n    php8.4-cli \\\n    php8.4-common \\\n    php8.4-curl \\\n    php8.4-mbstring \\\n    php8.4-xml \\\n    php8.4-zip \\\n    php8.4-pdo \\\n    php8.4-mysql \\\n    php8.4-pgsql \\\n    php8.4-sqlite3 \\\n    php8.4-intl \\\n    php8.4-pcntl \\\n    php8.4-opcache\n"})}),"\n",(0,t.jsx)(n.h2,{id:"install-database-cli-tools",children:"Install Database CLI Tools"}),"\n",(0,t.jsx)(n.p,{children:"Databasement requires database CLI tools to perform backup and restore operations."}),"\n",(0,t.jsx)(n.h3,{id:"for-mysqlmariadb-backups",children:"For MySQL/MariaDB backups"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Install MariaDB client (includes mariadb-dump and mariadb commands)\nsudo apt install -y mariadb-client\n\n# Or install MySQL client (includes mysqldump and mysql commands)\n# sudo apt install -y mysql-client\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["By default, Databasement uses MariaDB CLI tools (",(0,t.jsx)(n.code,{children:"mariadb-dump"}),", ",(0,t.jsx)(n.code,{children:"mariadb"}),"). If you prefer MySQL tools (",(0,t.jsx)(n.code,{children:"mysqldump"}),", ",(0,t.jsx)(n.code,{children:"mysql"}),"), set the environment variable ",(0,t.jsx)(n.code,{children:"MYSQL_CLI_TYPE=mysql"}),"."]})}),"\n",(0,t.jsx)(n.h3,{id:"for-postgresql-backups",children:"For PostgreSQL backups"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Install PostgreSQL client (includes pg_dump and psql commands)\nsudo apt install -y postgresql-client\n"})}),"\n",(0,t.jsx)(n.h3,{id:"for-sqlite-backups",children:"For SQLite backups"}),"\n",(0,t.jsx)(n.p,{children:"SQLite support is built into PHP - no additional tools needed."}),"\n",(0,t.jsx)(n.h2,{id:"install-composer",children:"Install Composer"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -sS https://getcomposer.org/installer | php\nsudo mv composer.phar /usr/local/bin/composer\n"})}),"\n",(0,t.jsx)(n.h2,{id:"install-nodejs",children:"Install Node.js"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -fsSL https://deb.nodesource.com/setup_22.x | sudo -E bash -\nsudo apt install -y nodejs\n"})}),"\n",(0,t.jsx)(n.h2,{id:"install-nginx",children:"Install Nginx"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo apt install -y nginx\n"})}),"\n",(0,t.jsx)(n.h2,{id:"step-6-download-and-configure-databasement",children:"Step 6: Download and Configure Databasement"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Clone the repository\ncd /var/www/databasement\ngit clone https://github.com/David-Crty/databasement.git .\n\n# Install PHP dependencies\ncomposer install --no-dev --optimize-autoloader\n\n# Install Node dependencies and build assets\nnpm install\nnpm run build\n\n# Publish Livewire assets\nphp artisan vendor:publish --force --tag=livewire:assets\n"})}),"\n",(0,t.jsx)(n.h2,{id:"configure-environment",children:"Configure Environment"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Generate application key\nphp artisan key:generate\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Edit the ",(0,t.jsx)(n.code,{children:".env"})," file with your configuration:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"nano .env\n"})}),"\n",(0,t.jsx)(n.p,{children:"Essential settings:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"APP_ENV=production\nAPP_DEBUG=false\nAPP_URL=https://your-domain.com\n\n# Database for Databasement (choose one)\n# SQLite (simplest)\nDB_CONNECTION=sqlite\nDB_DATABASE=/var/www/databasement/database/database.sqlite\n\n# Or MySQL\n# DB_CONNECTION=mysql\n# DB_HOST=127.0.0.1\n# DB_PORT=3306\n# DB_DATABASE=databasement\n# DB_USERNAME=databasement\n# DB_PASSWORD=your-password\n\n# Or PostgreSQL\n# DB_CONNECTION=pgsql\n# DB_HOST=127.0.0.1\n# DB_PORT=5432\n# DB_DATABASE=databasement\n# DB_USERNAME=databasement\n# DB_PASSWORD=your-password\n\n# Backup working directory\nBACKUP_WORKING_DIRECTORY=/tmp/backups\n"})}),"\n",(0,t.jsxs)(n.p,{children:["For all available environment variables, see the ",(0,t.jsx)(n.a,{href:"/databasement/self-hosting/configuration",children:"Configuration"})," page."]}),"\n",(0,t.jsx)(n.h2,{id:"run-database-migrations",children:"Run Database Migrations"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Run migrations\ncd /var/www/databasement\nphp artisan migrate --force\n"})}),"\n",(0,t.jsx)(n.h2,{id:"step-10-configure-nginx",children:"Step 10: Configure Nginx"}),"\n",(0,t.jsx)(n.p,{children:"Create a new Nginx configuration:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo nano /etc/nginx/sites-available/databasement\n"})}),"\n",(0,t.jsx)(n.p,{children:"Add the following configuration:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-nginx",children:'server {\n    listen 80;\n    server_name your-domain.com;\n    root /var/www/databasement/public;\n\n    add_header X-Frame-Options "SAMEORIGIN";\n    add_header X-Content-Type-Options "nosniff";\n\n    index index.php;\n\n    charset utf-8;\n\n    location / {\n        try_files $uri $uri/ /index.php?$query_string;\n    }\n\n    location = /favicon.ico { access_log off; log_not_found off; }\n    location = /robots.txt  { access_log off; log_not_found off; }\n\n    error_page 404 /index.php;\n\n    location ~ \\.php$ {\n        fastcgi_pass unix:/var/run/php/php8.4-fpm.sock;\n        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;\n        include fastcgi_params;\n        fastcgi_hide_header X-Powered-By;\n    }\n\n    location ~ /\\.(?!well-known).* {\n        deny all;\n    }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Enable the site:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo ln -s /etc/nginx/sites-available/databasement /etc/nginx/sites-enabled/\nsudo nginx -t\nsudo systemctl reload nginx\n"})}),"\n",(0,t.jsx)(n.h2,{id:"step-9-configure-queue-worker-systemd",children:"Step 9: Configure Queue Worker (Systemd)"}),"\n",(0,t.jsxs)(n.p,{children:["The queue worker is ",(0,t.jsx)(n.strong,{children:"required"})," to process backup and restore jobs."]}),"\n",(0,t.jsx)(n.p,{children:"Create a systemd service:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo nano /etc/systemd/system/databasement-queue.service\n"})}),"\n",(0,t.jsx)(n.p,{children:"Add the following:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ini",children:"[Unit]\nDescription=Databasement Queue Worker\nAfter=network.target\n\n[Service]\nUser=www-data\nGroup=www-data\nRestart=always\nRestartSec=5\nWorkingDirectory=/var/www/databasement\nExecStart=/usr/bin/php artisan queue:work --queue=backups,default --tries=3 --timeout=3600 --sleep=3 --max-jobs=1000\n\n[Install]\nWantedBy=multi-user.target\n"})}),"\n",(0,t.jsx)(n.p,{children:"Enable and start the service:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo systemctl daemon-reload\nsudo systemctl enable databasement-queue\nsudo systemctl start databasement-queue\n"})}),"\n",(0,t.jsx)(n.p,{children:"Check status:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo systemctl status databasement-queue\n"})}),"\n",(0,t.jsx)(n.h2,{id:"configure-scheduler-cron",children:"Configure Scheduler (Cron)"}),"\n",(0,t.jsx)(n.p,{children:"The scheduler runs automated backups based on your configured schedules."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"crontab -e\n"})}),"\n",(0,t.jsx)(n.p,{children:"Add this line:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cron",children:"* * * * * cd /var/www/databasement && php artisan schedule:run >> /dev/null 2>&1\n"})}),"\n",(0,t.jsx)(n.h2,{id:"verification",children:"Verification"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Open your browser and navigate to your domain"}),"\n",(0,t.jsx)(n.li,{children:"Create your first user account"}),"\n",(0,t.jsx)(n.li,{children:"Add a database server and test the connection"}),"\n",(0,t.jsx)(n.li,{children:"Create a backup to verify everything works"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Check Queue Worker Logs"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo journalctl -u databasement-queue -f\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Check PHP-FPM Logs"}),"\n",(0,t.jsx)(n.li,{children:"Check Nginx Logs"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"test-database-cli-tools",children:"Test Database CLI Tools"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Test MariaDB/MySQL client\nmariadb --version\n# or: mysql --version\n\n# Test PostgreSQL client\npsql --version\n\n# Test pg_dump\npg_dump --version\n"})}),"\n",(0,t.jsx)(n.h3,{id:"run-artisan-commands",children:"Run Artisan Commands"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"php artisan migrate:status\nphp artisan config:show database\n"})}),"\n",(0,t.jsx)(n.h2,{id:"updating-databasement",children:"Updating Databasement"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Pull latest changes\ngit pull origin main\n\n# Install dependencies\ncomposer install --no-dev --optimize-autoloader\nnpm install\nnpm run build\n\n# Run migrations\nphp artisan migrate --force\n\n# Clear caches\nphp artisan optimize:clear\n\n# Restart queue worker\nsudo systemctl restart databasement-queue\n"})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>r});var a=s(6540);const t={},i=a.createContext(t);function l(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);